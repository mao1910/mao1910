<!-- VISITOR BADGE -->
<!-- https://github.com/hehuapei/visitor-badge -->

<img align="right" src="https://visitor-badge.laobi.icu/badge?page_id=mao1910.mao1910&left_color=%2379DAF9&right_color=%23FE6E96" />


<!-- TYPING SVG -->
<!-- https://github.com/DenverCoder1/readme-typing-svg -->

<h1 align="center">
    <img src="https://readme-typing-svg.herokuapp.com/?font=Righteous&size=35&center=true&vCenter=true&width=500&height=70&color=FE6E96&font=poppins&duration=5000&lines=Hi+There!+üëã;+I'm+Mao!;" />
</h1>

<br/>

<!-- CODE/TERMINAL ABOUT ME -->
<h1 align="center">
<img src="./assets/terminal-5.gif" alt="Terminal" />
</h1>

<br/><br/><br/>


<!-- TECHNOLOGIES LOGOS -->
<!-- https://github.com/tandpfun/skill-icons -->

<h2 align="center">üíª Languages / Frameworks / Tools ‚öíÔ∏è</h2>
<div align="center">
    <img src="https://skillicons.dev/icons?i=javascript,typescript,angular,react,html,css,scss,bootstrap,cs,java,spring" />
    <img src="https://skillicons.dev/icons?i=flutter,firebase,supabase,mysql,git,github,gitlab,vscode,idea,maven,figma" />
</div>

<br/><br/><br/>


<!-- CONTRIBUTIONS SNAKE GAME -->
<!-- https://github.com/Platane/snk -->

<div align="center">
  <h2> My Contributionssssüêç </h2>
  <br>
  <img alt="contributions-eating Snake" src="https://raw.githubusercontent.com/mao1910/mao1910/output/github-contribution-grid-snake.svg" />

  <!-- Four lines below suggested by Planate for Dark mode-->
  <picture>
  <source media="(prefers-color-scheme: dark)" srcset="github-snake-dark.svg" />
  <source media="(prefers-color-scheme: light)" srcset="github-snake.svg" />
  </picture>
  
  <br/><br/><br/>
</div>


<!-- GITHUB STATS -->
<!-- https://github.com/DenverCoder1/github-readme-streak-stats -->
<!-- https://github.com/anuraghazra/github-readme-stats -->
<!-- https://github-readme-stats-mao1910.vercel.app/ My own Vercel deployment-->

<h2 align="center"> Statsüìù </h2>
  <br>
<div align=center>
  <img width=429 src="https://github-readme-stats-mao1910.vercel.app/api?username=mao1910&count_private=true&show_icons=true&theme=dracula&rank_icon=github&hide=contribs&border_radius=10&border_color=79DAF9" alt="github stats"/>
  <img width=396 src="https://streak-stats.demolab.com/?user=mao1910&count_private=true&theme=dracula&currStreakNum=79DAF9&currStreakLabel=FE6E96&border_radius=10&border=79DAF9" alt="streak stats"/>
  <br/>
  <img src="https://github-readme-stats-mao1910.vercel.app/api/top-langs/?username=mao1910&layout=compact&theme=dracula&border_radius=10&size_weight=0.5&count_weight=0.5&border_color=79DAF9" alt="languages stats" />
</div>

<br/><br/><br/>


<!-- FOOTER -->
<!-- https://github.com/DenverCoder1/readme-typing-svg -->
<!-- https://readme-typing-svg.demolab.com/demo/ -->

<a href="https://git.io/typing-svg"><img src="https://readme-typing-svg.demolab.com?font=Poppins&pause=1000&color=FE6E96&width=535&lines=Thanks+for+dropping+by!;Feel+free+to+check+any+of+the+Socials+below+%F0%9F%91%87;Or+the+Joke+Of+The+Day+if+you're+down+for+a+giggle+%F0%9F%98%9D;Hope+to+see+you+again+%F0%9F%91%8A;Uh%3F+You're+still+here%3F;Well...+I'm+running+out+of+things+to+say...;Tell+you+what%2C+due+to+your+effort+and+perseverance%2C;I+shall+present+you+with+a+short+poem%3A;%22To+code%2C+or+not+to+code%2C+that+is+the+question%3A;Whether+'tis+nobler+in+the+IDE+to+debug;The+errors+and+issues+of+outrageous+software%2C;Or+to+take+up+the+keyboard+against+a+sea+of+bugs;And+by+coding%2C+end+them.%22;by+William+Shakespeare%2C+probably.+;Pretty+sure+that's+Hamlet's.;Alrighty%2C+this+has+been+fun.;But+I'll+restart+the+loop+now...+see+ya+soon!" alt="Typing SVG" /></a>


<!--  SOCIAL NETWORKS -->
<!-- https://github.com/alexandresanlim/Badges4-README.md-Profile -->

  <div> 
    <a href="https://www.linkedin.com/" target="_blank"><img src="https://img.shields.io/badge/-LinkedIn-%230077B5?style=for-the-badge&logo=linkedin&logoColor=white" target="_blank"></a> <!-- ADD LINKEDIN PROFILE -->
    <a href = "https://www.google.com"><img src="https://img.shields.io/badge/Portfolio-4285F4?style=for-the-badge&logo=Google-chrome&logoColor=white" target="_blank"></a> <!-- ADD PORTFOLIO WEBSITE -->
    <a href="https://discord.gg" target="_blank"><img src="https://img.shields.io/badge/Discord-7289DA?style=for-the-badge&logo=discord&logoColor=white" target="_blank"></a> <!-- ADD DISCORD -->
    <a href = "mao1910dev@gmail.com"><img src="https://img.shields.io/badge/Gmail-D14836?style=for-the-badge&logo=gmail&logoColor=white" target="_blank"></a>
  </div>


<!-- SPOTIFY PLAYING-->
<!-- https://github.com/novatorem/novatorem -->
<!-- https://spotify-now-playing-novatorem-git-main-mao1910.vercel.app/ My own Vercel deployment-->

[<img width=438px src="https://spotify-now-playing-git-main-mao1910.vercel.app//api/spotify/?border_color=FE6E96" alt="Mao Spotify Now Playing" />](https://open.spotify.com/user/31542et242zglhf42ydrtqgvuvde)


<!-- JOKE OF THE DAY -->
<!-- https://github.com/ABSphreak/readme-jokes -->
<!-- https://readme-jokes-git-master-mao1910.vercel.app/ My own Vercel deployment-->

<details>
<summary>I've got a Joke for you. Wanna hear it? üôà</summary>

<br/>

 <tr>
 <td style="padding-top:4px"><img src = "https://readme-jokes-git-master-mao1910.vercel.app/api?&theme=dracula"></td>
 </tr>

</details>


<!-- ACTIVITY -->
<!-- https://github.com/jamesgeorge007/github-activity-readme -->


<details>
<summary>‚úçÔ∏è Activity</summary>

<br/>
<!-- START_SECTION:activity -->
<!--END_SECTION:activity-->

</details>


<!-- RSS FEED -->
<!-- https://github.com/gautamkrishnar/blog-post-workflow -->


<details>
<summary>üìï &nbsp;RSS feed</summary>

<br/>

<!-- BLOG-POST-LIST:START -->
 #### - [Data Communication : System design](https://dev.to/rajrathod/data-communication-system-design-3hgf) 
 <details><summary>Article</summary> <h2>
  
  
  Data Communication:
</h2>

<p>Data communication, also known as data networking or network communication, refers to the transmission of digital data between devices or systems over a network. It is a fundamental concept in computer science and telecommunications and plays a crucial role in enabling communication and data exchange in today's interconnected world. Here are key aspects and components of data communication:</p>

<p><strong>1. Data Transmission Medium</strong>:</p>

<ul>
<li>
<p><strong>Physical Media</strong>: Data can be transmitted over various physical mediums, including:</p>

<ul>
<li>
<strong>Copper Wire</strong>: Used in Ethernet and telephone connections.</li>
<li>
<strong>Fiber Optic Cable</strong>: Provides high-speed and long-distance data transmission.</li>
<li>
<strong>Wireless</strong>: Radio waves, microwaves, and satellite links are used for wireless communication.</li>
<li>
<strong>Coaxial Cable</strong>: Often used for cable television and some data networks.</li>
</ul>


</li>
<li><p><strong>Wireless Technologies</strong>: Wireless data communication includes Wi-Fi, cellular networks (3G, 4G, 5G), Bluetooth, and satellite communication.</p></li>
</ul>

<p><strong>2. Data Transmission Methods</strong>:</p>

<ul>
<li>
<strong>Serial vs. Parallel</strong>: Data can be transmitted serially (one bit at a time) or in parallel (multiple bits simultaneously).</li>
<li>
<strong>Synchronous vs. Asynchronous</strong>: In synchronous transmission, data is sent in synchronized frames, while asynchronous transmission does not require strict synchronization.</li>
</ul>

<p><strong>3. Network Protocols and Standards</strong>:</p>

<ul>
<li>
<strong>Protocols</strong>: Network protocols define rules and conventions for data communication. Examples include TCP/IP, HTTP, FTP, SMTP, and more.</li>
<li>
<strong>Standards</strong>: Standards organizations like the IEEE, ISO, and ITU develop specifications for networking and communication technologies, ensuring interoperability.</li>
</ul>

<p><strong>4. Network Topologies</strong>:</p>

<ul>
<li>
<strong>Physical Topology</strong>: Describes the physical layout of devices in a network, such as star, bus, ring, or mesh topologies.</li>
<li>
<strong>Logical Topology</strong>: Defines how data flows in the network, often based on protocols (e.g., Ethernet, Token Ring).</li>
</ul>

<p><strong>5. Network Devices</strong>:</p>

<ul>
<li>
<strong>Routers</strong>: Devices that connect different networks and route data between them.</li>
<li>
<strong>Switches</strong>: Devices that forward data within a local network based on MAC addresses.</li>
<li>
<strong>Firewalls</strong>: Network security devices that filter incoming and outgoing traffic.</li>
<li>
<strong>Modems</strong>: Devices that modulate and demodulate signals to enable digital data transmission over analog lines (e.g., DSL modems).</li>
</ul>

<p><strong>6. Network Layers</strong>:</p>

<ul>
<li>
<strong>OSI Model</strong>: The OSI (Open Systems Interconnection) model defines seven layers, each responsible for specific functions in data communication. These layers include physical, data link, network, transport, session, presentation, and application layers.</li>
</ul>

<p><strong>7. Transmission Modes</strong>:</p>

<ul>
<li>
<strong>Simplex</strong>: Data flows in one direction only (e.g., TV broadcast).</li>
<li>
<strong>Half-Duplex</strong>: Data can flow in both directions but not simultaneously (e.g., walkie-talkies).</li>
<li>
<strong>Full-Duplex</strong>: Data can flow in both directions simultaneously (e.g., phone conversation).</li>
</ul>

<p><strong>8. Error Detection and Correction</strong>:</p>

<ul>
<li>Techniques like checksums and error-correcting codes are used to detect and correct errors in transmitted data.</li>
</ul>

<p><strong>9. Data Encoding and Modulation</strong>:</p>

<ul>
<li>Data is often encoded into electrical, optical, or radio wave signals for transmission. Techniques like modulation are used to represent digital data in analog signals.</li>
</ul>

<p><strong>10. Network Security and Encryption</strong>:</p>

<ul>
<li>Data communication often involves security measures to protect data from unauthorized access and eavesdropping. Encryption and secure protocols are used for secure communication.</li>
</ul>

<p><strong>11. Bandwidth and Data Rate</strong>:</p>

<ul>
<li>Bandwidth represents the capacity of a communication channel, while data rate refers to the speed at which data is transmitted.</li>
</ul>

<p><strong>12. Data Routing</strong>:</p>

<ul>
<li>Data is routed through networks using routing algorithms and tables that determine the best path from the source to the destination.</li>
</ul>

<p>Data communication is the foundation of the internet, telecommunication networks, and various other communication systems. It enables the exchange of information, multimedia content, and real-time interactions across the globe, impacting various aspects of modern life, from business and education to entertainment and healthcare.</p>

<h2>
  
  
  Application Layer:
</h2>

<p>The application layer is one of the seven layers in the OSI (Open Systems Interconnection) model and one of the five layers in the TCP/IP model. It is the topmost layer in both models and plays a fundamental role in network communication, as it focuses on end-user services and applications. Here's an overview of the application layer:<br>
<a href="https://res.cloudinary.com/practicaldev/image/fetch/s--vkG17HvF--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_800/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/opg7tsvapbmdpcssq9fj.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--vkG17HvF--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_800/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/opg7tsvapbmdpcssq9fj.png" alt="Image description" width="585" height="359"></a></p>

<p><strong>Key Functions of the Application Layer</strong>:</p>

<ol>
<li><p><strong>End-User Services</strong>: The primary purpose of the application layer is to provide various network services directly to end-users or applications. It acts as an interface between the network and the user, ensuring that applications can communicate over the network.</p></li>
<li><p><strong>Application Protocols</strong>: The application layer defines various protocols and standards for specific applications and services to communicate with one another. These protocols determine how data is formatted, transmitted, and received by applications.</p></li>
<li><p><strong>Data Presentation and Translation</strong>: The application layer is responsible for data presentation and conversion. It ensures that data is in a format that the receiving application can understand and interpret. This includes tasks like data encryption, compression, and character set conversion.</p></li>
<li><p><strong>Session Management</strong>: The application layer can establish, maintain, and terminate communication sessions between applications. It helps manage the flow of data and ensures that information is synchronized between sender and receiver.</p></li>
<li><p><strong>Application Identification and Addressing</strong>: The application layer defines mechanisms for identifying applications and services on a network, typically using port numbers or other identifiers. This enables routers and switches to forward data to the appropriate destination.</p></li>
<li><p><strong>User Authentication and Authorization</strong>: Some application layer protocols and services handle user authentication and authorization, ensuring that only authorized users can access certain resources or services.</p></li>
<li><p><strong>File Transfer and Remote Access</strong>: Protocols like FTP (File Transfer Protocol) and SSH (Secure Shell) operate at the application layer and enable file transfer and remote access to servers.</p></li>
<li><p><strong>Email Services</strong>: Email protocols such as SMTP (Simple Mail Transfer Protocol) for sending emails and POP3/IMAP for receiving emails operate at the application layer.</p></li>
<li><p><strong>Web Services</strong>: HTTP (Hypertext Transfer Protocol), used for web browsing and web-based applications, is a key application layer protocol.</p></li>
</ol>

<p><strong>Examples of Application Layer Protocols and Services</strong>:</p>

<ul>
<li>
<strong>HTTP/HTTPS</strong>: Hypertext Transfer Protocol and its secure version are used for web browsing and web services.</li>
<li>
<strong>SMTP</strong>: Simple Mail Transfer Protocol is used for sending email.</li>
<li>
<strong>POP3/IMAP</strong>: Post Office Protocol and Internet Message Access Protocol are used for receiving email.</li>
<li>
<strong>FTP</strong>: File Transfer Protocol is used for transferring files.</li>
<li>
<strong>SSH</strong>: Secure Shell is used for secure remote access and management of network devices.</li>
<li>
<strong>DNS</strong>: Domain Name System resolves domain names into IP addresses.</li>
<li>
<strong>SNMP</strong>: Simple Network Management Protocol is used for managing and monitoring network devices.</li>
<li>
<strong>TELNET</strong>: Used for remote terminal access (not secure).</li>
</ul>

<p>The application layer is critical for enabling communication between different software applications and services across a network. It provides the necessary abstractions and protocols to facilitate this communication, ensuring that data is exchanged accurately and efficiently.</p>

<h2>
  
  
  Network Protocols:
</h2>

<p>HTTP (Hypertext Transfer Protocol), TCP (Transmission Control Protocol), and UDP (User Datagram Protocol) are fundamental protocols in computer networking that play essential roles in data communication and web services. Each protocol serves a specific purpose and has its characteristics and use cases. Here's an overview of each:<br>
<a href="https://res.cloudinary.com/practicaldev/image/fetch/s--RKMceQE8--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_800/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/b0l6a19qac8dhho1l3sj.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--RKMceQE8--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_800/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/b0l6a19qac8dhho1l3sj.png" alt="Image description" width="697" height="537"></a></p>

<p><strong>HTTP (Hypertext Transfer Protocol)</strong>:</p>

<ul>
<li>
<strong>Purpose</strong>: HTTP is an application layer protocol used for transferring hypertext (text-based documents with links) and other data between a client (typically a web browser) and a web server.</li>
<li>
<strong>Characteristics</strong>:

<ul>
<li>Request-Response Model: HTTP follows a client-server model where a client sends requests to a web server, and the server responds with the requested content.</li>
<li>Stateless: HTTP is stateless, meaning each request-response cycle is independent, and the server doesn't retain information about previous requests from the same client.</li>
<li>Connectionless: By default, HTTP uses a connectionless model where each request/response is a separate connection. However, HTTP/1.1 introduced the option to reuse connections (HTTP Keep-Alive) for multiple requests.</li>
</ul>


</li>
<li>
<strong>Use Cases</strong>: HTTP is the foundation of the World Wide Web and is used for browsing websites, fetching resources like HTML pages, images, videos, and interacting with web services through APIs (e.g., RESTful APIs).</li>
</ul>

<p><strong>TCP (Transmission Control Protocol)</strong>:</p>

<ul>
<li>
<strong>Purpose</strong>: TCP is a transport layer protocol that provides reliable, connection-oriented, and stream-oriented data communication between two devices in a network.</li>
<li>
<strong>Characteristics</strong>:

<ul>
<li>Reliable: TCP ensures the reliable delivery of data by acknowledging received packets, retransmitting lost packets, and ordering received packets.</li>
<li>Connection-Oriented: TCP establishes a connection before data exchange and terminates the connection after communication.</li>
<li>Stream-Oriented: TCP treats data as a continuous stream of bytes, providing a byte-stream interface to applications.</li>
</ul>


</li>
<li>
<strong>Use Cases</strong>: TCP is commonly used for applications where data reliability and ordering are critical, such as web browsing, email, file transfer (e.g., FTP), and remote access (e.g., SSH).</li>
</ul>

<p><strong>UDP (User Datagram Protocol)</strong>:</p>

<ul>
<li>
<strong>Purpose</strong>: UDP is a transport layer protocol that provides a connectionless and lightweight method for sending datagrams (packets) of data between devices in a network.</li>
<li>
<strong>Characteristics</strong>:

<ul>
<li>Connectionless: UDP does not establish a connection before sending data and does not guarantee the delivery or ordering of data packets.</li>
<li>Lightweight: UDP has lower overhead compared to TCP because it lacks features like flow control and error correction.</li>
<li>Low Latency: UDP is preferred for real-time applications where low latency is crucial, such as VoIP, online gaming, and multimedia streaming.</li>
</ul>


</li>
<li>
<strong>Use Cases</strong>: UDP is suitable for applications where real-time communication is more important than data integrity, such as video conferencing, DNS, DHCP, and various real-time protocols.
Remote Procedure Call (RPC), gRPC, REST, and GraphQL are all protocols and technologies used for building APIs and enabling communication between clients and servers in distributed systems. Each of these technologies has its own characteristics and use cases. Here's an in-depth explanation of each:</li>
</ul>

<p><strong>Remote Procedure Call (RPC)</strong>:</p>

<ul>
<li>
<strong>Purpose</strong>: RPC is a protocol that allows a program or function to execute code on a remote server or service as if it were a local function call. It abstracts the complexities of network communication, making it appear as if the client is invoking a function on the server.</li>
<li>
<strong>Characteristics</strong>:

<ul>
<li>Synchronous: RPC calls are typically synchronous, meaning the client waits for the remote procedure to complete and return a response.</li>
<li>Language Agnostic: RPC can work across different programming languages, allowing clients and servers to be written in different languages.</li>
<li>Communication Overhead: RPC may involve serialization/deserialization of data and network communication, which can add overhead.</li>
</ul>


</li>
<li>
<strong>Use Cases</strong>: RPC is commonly used in scenarios where you need direct control over remote services and want to make remote calls feel like local calls. Examples include remote method invocation in Java RMI and gRPC.</li>
</ul>

<p><strong>gRPC</strong>:</p>

<ul>
<li>
<strong>Purpose</strong>: gRPC is an open-source RPC framework developed by Google. It uses HTTP/2 as the transport protocol and Protocol Buffers (protobuf) as the interface definition language (IDL) to define services and message structures.</li>
<li>
<strong>Characteristics</strong>:

<ul>
<li>Strongly Typed: gRPC uses Protocol Buffers to define APIs and data structures, providing strong typing and code generation.</li>
<li>Language Agnostic: Similar to RPC, gRPC allows communication between clients and servers implemented in different programming languages.</li>
<li>Bidirectional Streaming: gRPC supports bidirectional streaming, enabling both clients and servers to send multiple messages in a single RPC.</li>
</ul>


</li>
<li>
<strong>Use Cases</strong>: gRPC is well-suited for building efficient and performant APIs in microservices architectures. It's commonly used in scenarios where high performance, strong typing, and bidirectional communication are important.</li>
</ul>

<p><strong>REST (Representational State Transfer)</strong>:</p>

<ul>
<li>
<strong>Purpose</strong>: REST is an architectural style for designing networked applications. It is based on a set of principles and constraints that define how resources are identified and addressed via URLs, and how they can be manipulated using a limited set of standardized HTTP methods.</li>
<li>
<strong>Characteristics</strong>:

<ul>
<li>Stateless: RESTful services are stateless, meaning each request from a client to a server must contain all the information needed to understand and process the request.</li>
<li>CRUD Operations: REST maps CRUD (Create, Read, Update, Delete) operations to HTTP methods (POST, GET, PUT, DELETE) for resource manipulation.</li>
<li>Representations: Resources in REST can have multiple representations (e.g., JSON, XML, HTML), and clients can specify their preferred representation.</li>
</ul>


</li>
<li>
<strong>Use Cases</strong>: REST is widely used for building APIs on the web, including web services, social media APIs, and any scenario where stateless communication over HTTP is appropriate.</li>
</ul>

<p><strong>GraphQL</strong>:</p>

<ul>
<li>
<strong>Purpose</strong>: GraphQL is a query language and runtime for APIs that allows clients to request only the data they need and nothing more. It provides a flexible and efficient approach to data retrieval and manipulation.</li>
<li>
<strong>Characteristics</strong>:

<ul>
<li>Flexible Queries: Clients can specify exactly what data they need in their queries, reducing over-fetching or under-fetching of data.</li>
<li>Strongly Typed: GraphQL APIs are strongly typed and introspective, meaning the schema is self-documenting, and clients can discover available operations and types.</li>
<li>Single Endpoint: GraphQL typically exposes a single endpoint for all API operations, making it easier to manage and optimize.</li>
</ul>


</li>
<li>
<strong>Use Cases</strong>: GraphQL is suitable for scenarios where clients have diverse data needs, need to reduce over-fetching of data, or want to consolidate multiple API endpoints into a single endpoint. It is often used in modern web and mobile app development.</li>
</ul>

 </details> 
 <hr /> 

 #### - [Self-developed PSD parser dynamically generates static code to improve your development efficiency](https://dev.to/yuanmr/self-developed-psd-parser-dynamically-generates-static-code-to-improve-your-development-efficiency-200c) 
 <details><summary>Article</summary> <h2>
  
  
  Preface
</h2>

<p>Hello everyone, welcome to the <code>Useless Innovation</code> technology channel. That's right! You read that right, here is a combination of useless technologies or technologies that are rarely touched in daily life. Innovate a more useless tool and provide it for everyone to use. Therefore, we call it <code>useless innovation</code>, or we can also call it <code>berry innovation</code>.</p>

<h2>
  
  
  Finished product display
</h2>

<p>Before explaining my development and learning process, I will first share the tools with everyone. If you want to know more about us or want to learn and cooperate, you can send me a private message. Quick access addressÔºö<a href="http://meichuang.org.cn/meichuangToos/#/index">http://meichuang.org.cn/meichuangToos/#/index</a></p>

<h2>
  
  
  front page
</h2>

<p>When you enter the homepage of the platform, you can see a very simple style, which is mainly divided into three areas: the header area, the introduction area, and the functional module area. What we developed this time: the ‚Äúuseless‚Äù static code generator tool is our first product, also known as Pixel Partner.</p>

<p>*When I chose this name, I wanted this tool to be your partner in the development process. It can help you complete the task of cutting pictures at any time, so that you are no longer a picture cutting boy. *</p>

<p><a href="https://res.cloudinary.com/practicaldev/image/fetch/s--TIPKnLDx--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_800/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/rryzsqgdyk5924vb3odm.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--TIPKnLDx--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_800/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/rryzsqgdyk5924vb3odm.png" alt="home" width="800" height="444"></a></p>

<h2>
  
  
  Pixel Partner
</h2>

<p>When you enter the Pixel Partner tool, you will be asked by default to upload a PSD mockup first. After the upload is completed, it will help you with cutting, rendering and other actions, and finally enter the console.</p>

<p><a href="https://res.cloudinary.com/practicaldev/image/fetch/s--XntJ4RLI--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_800/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/1m925bybdk8chtbiay5h.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--XntJ4RLI--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_800/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/1m925bybdk8chtbiay5h.png" alt="import" width="800" height="445"></a></p>

<p><strong>The console page is divided into three modules:</strong></p>

<ol>
<li>File preview area on the left: You can upload multiple psds and switch at any time.</li>
<li>The page preview area in the middle: preview the corresponding psd interface.</li>
<li>Ribbon on the right: Set the configuration of download code.</li>
</ol>

<p><a href="https://res.cloudinary.com/practicaldev/image/fetch/s--lt_tmprU--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_800/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/nl3foqy1ireaatqgt02m.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--lt_tmprU--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_800/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/nl3foqy1ireaatqgt02m.png" alt="preview" width="800" height="446"></a></p>

<p>Mainly explain the functions of the functional area:</p>

<ol>
<li>Source code type: Generate code using the syntax and rules of the corresponding type. Contains HTML, Vue2.x, React, Uniapp, WeChat applet</li>
<li>Size standard: The page adapts to the size. According to the value you fill in, all the elements of the page are generated to the corresponding adapted size, so that they can be perfectly presented on the page.</li>
<li>Unit standard: According to the size and unit, it can be adapted to the display of different clients. Contains PX, REM, VH, VW</li>
<li>Font: Upload the corresponding text font to restore the visual draft.</li>
</ol>

<p><a href="https://res.cloudinary.com/practicaldev/image/fetch/s--eul0SFSp--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_800/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/lf9n6tfcta4r9molrz8d.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--eul0SFSp--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_800/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/lf9n6tfcta4r9molrz8d.png" alt="ribbon" width="800" height="1520"></a></p>

<h2>
  
  
  Self-test
</h2>

<p>After the development was completed, we also conducted self-tests for a period of time to summarize the overall integrity of the current website.</p>

<ol>
<li>Parse poster-related PSD files, which can be perfectly parsed, as long as the corresponding font file is uploaded (<strong>This is very important</strong>). Our company is also using it now, which basically saves one or two people‚Äôs working hours (the boss is very satisfied).</li>
<li>The layout is not strong, and it is not very friendly to the management backend or daily business viewing pages. The current overall layout is based on positioning and has no structure. We are constantly making breakthroughs in this regard (<strong>If you have the ability and interest in this area People can join our small team, and we can open source in this area</strong>)</li>
<li>The recognition is not strong and cannot be recognized as input boxes, tables, icons, etc. We are also looking for a breakthrough point for this. To be honest, it is a bit difficult. There is no one in this field (<strong>If anyone is willing to teach us how to train large models, please send me a private message, or if you are willing to cooperate</strong>)</li>
</ol>

<h2>
  
  
  Summarize
</h2>

<p>The above introduction ends here. The operation is very simple, and the function of generating page code is also very nice. Everyone can try it. Maybe it will be helpful to you, <code>I introduced this tool to a friend, and he directly used it to take orders to develop pages. He complained that he could borrow more orders for drawing static pages.</code>I secretly envy people who have private contracts. That‚Äôs it for this issue, see you next time.</p>

 </details> 
 <hr /> 

 #### - [Lidando com regress√£o visual: enfrentando desafios com Django, Selenium e Pillow](https://dev.to/eduardojm/lidando-com-regressao-visual-enfrentando-desafios-com-django-selenium-e-pillow-o8d) 
 <details><summary>Article</summary> <p>O <strong>django-image-uploader-widget</strong> √© um projeto de componente de upload de imagem para o <strong>django</strong>. Por motivos de retrocompatibilidade entre as vers√µes 3.x e 4.x do <strong>django</strong>, foi decidido implementar testes de regress√£o visual utilizando <strong>Selenium</strong> e <strong>Pillow</strong>. Nesse texto vamos trabalhar esse tema e seus desafios.</p>

<h2>
  
  
  √çndice
</h2>

<ul>
<li>Introdu√ß√£o</li>
<li>O suporte do django a suas vers√µes</li>
<li>O que √© um teste de regress√£o visual?</li>
<li>O Browser e o Selenium</li>
<li>Pillow</li>
<li>Juntando as Pe√ßas</li>
<li>
Desafios

<ul>
<li>O problema inicial</li>
<li>Altera√ß√£o nas fontes</li>
<li>Anima√ß√µes, transi√ß√µes e threshold</li>
<li>Theme Toggle</li>
</ul>


</li>
<li>Refer√™ncias</li>
</ul>

<h2>
  
  
  Introdu√ß√£o <a></a>
</h2>

<p>O <a href="https://github.com/inventare/django-image-uploader-widget">django-image-uploader-widget</a> √© um projeto de componente de upload de imagem para o <strong>django</strong>, criado para melhorar a est√©tica dos <em>uploaders</em> originais. √â mantido como open-source desde o in√≠cio, inclusive recebendo colabora√ß√µes de outros desenvolvedores.</p>

<p><a href="https://res.cloudinary.com/practicaldev/image/fetch/s--yMzmwO7C--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_800/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/t0pzhx6vm8kwio4xf5i9.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--yMzmwO7C--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_800/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/t0pzhx6vm8kwio4xf5i9.png" alt="Visualiza√ß√£o do Componente" width="800" height="160"></a></p>

<p>Com o lan√ßamento das vers√µes 4.x do django, o componente passou a ter diferen√ßas significativas no visual entre algumas de suas vers√µes, conforme registrado na issue <a href="https://github.com/inventare/django-image-uploader-widget/issues/96#issuecomment-1690740705">#96</a>.</p>

<p>A partir dessa diferen√ßa visual, em diferentes vers√µes do <strong>django</strong>, entra no radar do projeto a possibilidade de implementa√ß√£o de testes de regress√£o visual. Nesse artigo vamos explorar os desafios enfrentados durante essa implementa√ß√£o.</p>

<h2>
  
  
  O suporte do django a suas vers√µes <a></a>
</h2>

<p>Um ponto que vale ser levado em considera√ß√£o, para justificar a decis√£o de implementar testes de regress√£o visual, √© o fato de que o <strong>django</strong> mantem, por muito tempo, suporte a diversas de suas vers√µes (<a href="https://www.djangoproject.com/download/">Ver Refer√™ncia</a>), como na imagem:</p>

<p><a href="https://res.cloudinary.com/practicaldev/image/fetch/s--xwpjDp3c--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_800/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/03mlns5lyp7k2s16drdr.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--xwpjDp3c--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_800/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/03mlns5lyp7k2s16drdr.png" alt="django supported versions roadmap" width="800" height="369"></a></p>

<h2>
  
  
  O que √© um teste de regress√£o visual? <a></a>
</h2>

<p>Como o Guilherme Ananias comenta no seu texto (<a href="https://dev.to/woovi/avoiding-ui-regressions-with-jest-49f3">Ver Refer√™ncia</a>), um teste de regress√£o visual √© um tipo de teste que ir√° garantir que qualquer altera√ß√£o no c√≥digo n√£o ir√° alterar a forma como o usu√°rio final ir√° ver√° esse componente ou p√°gina.</p>

<p>Dado o contexto de suporte a m√∫ltiplas vers√µes do <strong>django</strong> e, principalmente, do <strong>django-admin</strong>, com altera√ß√µes de estiliza√ß√£o entre as vers√µes, esse tipo de teste pode, tamb√©m, ser utilizado para garantir retrocompatibilidade entre o componente e as vers√µes do <strong>django</strong>.</p>

<h2>
  
  
  O Browser e o Selenium <a></a>
</h2>

<p>O c√≥digo desse componente j√° possu√≠a uma suite de testes, funcionais, rodando com o <strong>Selenium</strong> e o <strong>Chrome Driver</strong>. A justificativa para o uso de testes funcionais pode ser lida nas <a href="https://inventare.github.io/django-image-uploader-widget/docs/development/tests/">documenta√ß√µes do projeto</a>.</p>

<p>Tendo o browser e, mais especificamente, o <strong>selenium</strong> dispon√≠veis, √© poss√≠vel utilizar o m√©todo <code>screenshot(filename)</code> para salvar um <em>screenshot</em> de um elemento da p√°gina, conforme <a href="https://selenium-python.readthedocs.io/api.html#selenium.webdriver.remote.webelement.WebElement.screenshot">documenta√ß√£o</a>.</p>

<h2>
  
  
  Pillow <a></a>
</h2>

<p>A utiliza√ß√£o dos campos de imagem do <strong>django</strong> s√≥ √© poss√≠vel com a biblioteca <strong>Pillow</strong> instalada no projeto. Essa biblioteca traz, com a sua instala√ß√£o, m√©todos para lidar com a diferen√ßa entre imagens (<a href="https://pillow.readthedocs.io/en/stable/reference/ImageChops.html#PIL.ImageChops.difference">Ver Refer√™ncia</a>).</p>

<h2>
  
  
  Juntando as Pe√ßas <a></a>
</h2>

<p>Ao utilizar o <strong>selenium</strong> e a lib <strong>Pillow</strong> √© poss√≠vel, de forma bem simples, tirar <em>screenshot</em> dos elementos e comparar com outro <em>screenshot</em> j√° armazenado (<a href="https://github.com/inventare/django-image-uploader-widget/blob/main/utils/tests/snapshot.py#L188">ver implementa√ß√£o</a>).</p>

<h2>
  
  
  Desafios <a></a>
</h2>

<p>Foram enfrentados diversos desafios durante a implementa√ß√£o dos testes de regress√£o visual. Alguns desses desafios foram causados pela natureza das escolhas para a implementa√ß√£o desses testes e outros pela natureza do <strong>django</strong> e <strong>django-admin</strong>.</p>

<h3>
  
  
  O problema inicial <a></a>
</h3>

<p>Toda a implementa√ß√£o dos testes de regress√£o visual nasceram devido a um problema entre vers√µes do django, vide <a href="https://github.com/inventare/django-image-uploader-widget/issues/96#issuecomment-1690740705">#96</a>, onde, devido a altera√ß√£o de estilos do <strong>django-admin</strong>, adicionando <code>flexbox</code>, causou a quebra da estiliza√ß√£o.</p>

<p>Assim, √© necess√°rio dizer que um dos primeiros desafios √© da natureza do <strong>django</strong> e, principalmente, do suporte a m√∫ltiplas vers√µes do mesmo.</p>

<p>A solu√ß√£o, pra esse caso, em espec√≠fico, foi simples e corriqueira fazendo o tratamento tanto pro <strong>css</strong> das vers√µes 3.x do <strong>django-admin</strong> quanto para as novas, que utilizam <code>flexbox</code>.</p>

<h3>
  
  
  Altera√ß√£o nas fontes <a></a>
</h3>

<p>Complementando o problema inicial, logo nos primeiros testes, foi identificado uma altera√ß√£o no padr√£o visual do componente (ou <em>widget</em>), em uma das vers√µes mais recentes do <strong>django</strong>. As fontes do <em>widget</em> estavam diferentes. Ao buscar pelas <em>releases notes</em> do <strong>django</strong>, √© observado a seguinte descri√ß√£o (<a href="https://docs.djangoproject.com/en/4.2/releases/4.2/">refer√™ncia</a>):</p>

<blockquote>
<p>The admin‚Äôs font stack now prefers system UI fonts and no longer requires downloading fonts. Additionally, CSS variables are available to more easily override the default font families.</p>
</blockquote>

<p>Uma solu√ß√£o, n√£o necessariamente a melhor, por√©m a mais simples foi a de adiantar essa altera√ß√£o das fontes, para o componente de upload de imagens, independente da vers√£o do <strong>django</strong>.</p>

<h3>
  
  
  Anima√ß√µes, transi√ß√µes e threshold <a></a>
</h3>

<p>Da natureza da compara√ß√£o das imagens, junto ao fato de ser uma aplica√ß√£o <em>web</em> executando, tem-se o problema de ter alguns pixeis de diferen√ßa em algumas situa√ß√µes, provavelmente causado por anima√ß√µes e transi√ß√µes.</p>

<p>Para aguardar o fim das transi√ß√µes e anima√ß√µes, o m√©todo <code>time.sleep()</code> do Python foi utilizado. Por conta da utiliza√ß√£o do <code>time.sleep()</code> √©, natural, que o tempo de execu√ß√£o dos testes aumente significativamente.</p>

<blockquote>
<p>Nesse ponto, √© sempre importante deixar pontuado que, n√£o existe certo ou errado, ou solu√ß√£o pra todos os problemas, ou, ainda, solu√ß√£o sem contrapontos. Toda t√©cnica, ou escolha, geralmente, tem suas vantagens e desvantagens. Cabe ponderar se as vantagens superam as desvantagens no contexto ao qual se quer utilizar a ferramenta.</p>
</blockquote>

<p>Por fim, ap√≥s a implementa√ß√£o do <code>time.sleep()</code> raras se tornaram as vezes que as imagens divergiam em locais que n√£o deveriam, por√©m, por garantia, ainda foi implementado um sistema de compara√ß√£o com <em>threshold</em> (limiar) para esses casos.</p>

<h3>
  
  
  Theme Toggle <a></a>
</h3>

<p>Ainda nas <em>release notes</em> da vers√£o <strong>4.2</strong> do <strong>django</strong> √© poss√≠vel verificar a adi√ß√£o de um <em>theme toggle</em> no admin. Quando o componente foi, inicialmente, desenvolvido, as vers√µes 4.x do <em>django</em> ainda n√£o tinham assumido o status de <strong>LTS</strong>. Al√©m disso, por um tempo, apenas as manuten√ß√µes b√°sicas foram dadas ao projeto. Dados esses contextos, o componente n√£o tinha suporte a mudan√ßa de tema pela interface de usu√°rio.</p>

<p>Esse problema s√≥ foi percebido, de fato, com a implementa√ß√£o dos testes de regress√£o visual e, para a solu√ß√£o, foi aberta uma nova issue no GitHub (<a href="https://github.com/inventare/django-image-uploader-widget/issues/103">#103</a>).</p>

<p>Esse foi o √∫nico caso em que foi implementada uma condicional da vers√£o do <strong>django</strong> em que os testes estavam sendo executados:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight python"><code><span class="kn">import</span> <span class="nn">django</span>
<span class="c1"># ...
</span>
<span class="k">class</span> <span class="nc">InlineEditorUIRegressionTestCase</span><span class="p">(</span><span class="n">IUWTestCase</span><span class="p">):</span>
    <span class="c1"># ...
</span>    <span class="k">def</span> <span class="nf">test_ui_initialized_toggle_dark_theme_inverted</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">dark_mode</span><span class="p">()</span>

        <span class="n">major</span><span class="p">,</span> <span class="n">minor</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">django</span><span class="p">.</span><span class="n">VERSION</span>
        <span class="k">if</span> <span class="n">major</span> <span class="o">&lt;</span> <span class="mi">4</span> <span class="ow">or</span> <span class="n">minor</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span>
</code></pre>

</div>






<h2>
  
  
  Refer√™ncias <a></a>
</h2>

<p>As refer√™ncias citadas no texto, listadas:</p>

<ul>
<li><a href="https://github.com/inventare/django-image-uploader-widget">django-image-uploader-widget</a></li>
<li><a href="https://github.com/inventare/django-image-uploader-widget/issues/96#issuecomment-1690740705">django-image-uploader-widget#96</a></li>
<li><a href="https://www.djangoproject.com/download/">Download - Django</a></li>
<li><a href="https://dev.to/woovi/avoiding-ui-regressions-with-jest-49f3">Avoiding UI Regressions With Jest</a></li>
<li><a href="https://inventare.github.io/django-image-uploader-widget/docs/development/tests/">Tests - django-image-uploader-widget docs</a></li>
<li><a href="https://selenium-python.readthedocs.io/api.html#selenium.webdriver.remote.webelement.WebElement.screenshot">Selenium Docs</a></li>
<li><a href="https://pillow.readthedocs.io/en/stable/reference/ImageChops.html#PIL.ImageChops.difference">Pillow Docs</a></li>
<li><a href="https://github.com/inventare/django-image-uploader-widget/blob/main/utils/tests/snapshot.py#L188">django-image-uploader-widget/snapshot.py</a></li>
<li><a href="https://docs.djangoproject.com/en/4.2/releases/4.2/">Django - Django 4.2 Release</a></li>
<li><a href="https://github.com/inventare/django-image-uploader-widget/issues/103">django-image-uploader-widget#103</a></li>
</ul>




<p>Foto de <a href="https://unsplash.com/pt-br/@buudkaanaa?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Budka Damdinsuren</a> na <a href="https://unsplash.com/pt-br/fotografias/xihqiK6rD9k?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Unsplash</a></p>

 </details> 
 <hr /> 

 #### - [Dark Mode with Next.js, TypeScript, Styled Components and Redux ToolkitüîØüîÆ](https://dev.to/koyablue/dark-mode-with-nextjs-typescript-styled-components-and-redux-toolkit-3863) 
 <details><summary>Article</summary> <p>Hi üëã<br>
Thank you for taking time to read this article!</p>

<p>One of the most common features we implement is dark mode. However, after implementing dark mode once in a project, it's easy to forget how it was implemented because there's no opportunity to implement it for a while. <br>
So I decided to put together an article on the method I use most often so that everyone can check it anytime!</p>
<h2>
  
  
  Table of Contents
</h2>

<p>¬†1. Tech stack<br>
¬†2. Step-by-step implementation</p>

<p>¬†¬†¬†¬†¬†¬† 2.1. Configs, constants and types for color themes</p>

<p>¬†¬†¬†¬†¬†¬† 2.2. Set up Redux Toolkit</p>

<p>¬†¬†¬†¬†¬†¬† 2.3. Utility functions to handle color theme cookie</p>

<p>¬†¬†¬†¬†¬†¬† 2.4. Implement useColorTheme custom hook</p>

<p>¬†¬†¬†¬†¬†¬† 2.5. Configure RTK and Styled Components in _app.tsx<br>
¬†3. Let's implement dark mode toggle switch</p>
<h2>
  
  
  Tech stack
</h2>

<p>The language, libraries and frameworks used for the implementation are as follows:</p>

<ul>
<li>Next.js</li>
<li>TypeScript</li>
<li>Styled Components</li>
<li>Redux Toolkit</li>
<li>cookies-next</li>
</ul>
<h2>
  
  
  Step-by-step implementation
</h2>
<h3>
  
  
  Configs, constants and types for color themes
</h3>

<p>First, let's define the constants and types needed to manage the color theme.<br>
in <code>const/colorTheme.ts</code><br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="c1">// const/colorTheme.ts</span>

<span class="c1">// Types of available color themes</span>
<span class="k">export</span> <span class="kd">const</span> <span class="nx">colorThemeNames</span> <span class="o">=</span> <span class="p">[</span>
  <span class="dl">'</span><span class="s1">light</span><span class="dl">'</span><span class="p">,</span>
  <span class="dl">'</span><span class="s1">dark</span><span class="dl">'</span><span class="p">,</span>
<span class="p">]</span> <span class="k">as</span> <span class="kd">const</span><span class="p">;</span>

<span class="c1">// Can't use type ColorThemeName because of circular dependency</span>
<span class="k">export</span> <span class="kd">const</span> <span class="nx">defaultColorThemeName</span><span class="p">:</span> <span class="k">typeof</span> <span class="nx">colorThemeNames</span><span class="p">[</span><span class="kr">number</span><span class="p">]</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">light</span><span class="dl">'</span><span class="p">;</span>

<span class="c1">// Cookie key for color theme</span>
<span class="k">export</span> <span class="kd">const</span> <span class="nx">colorThemeCookieName</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">myAppColorTheme</span><span class="dl">'</span><span class="p">;</span>

</code></pre>

</div>



<p>and</p>

<p>in <code>types/colorTheme.ts</code><br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="c1">// types/colorTheme.ts</span>

<span class="k">import</span> <span class="p">{</span> <span class="nx">colorThemeNames</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">../const/colorTheme</span><span class="dl">'</span><span class="p">;</span>

<span class="k">export</span> <span class="kd">type</span> <span class="nx">ColorThemeStyle</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">colors</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">text</span><span class="p">:</span> <span class="kr">string</span>
    <span class="na">background</span><span class="p">:</span> <span class="kr">string</span>
    <span class="na">componentBackground</span><span class="p">:</span> <span class="kr">string</span>
    <span class="na">border</span><span class="p">:</span> <span class="kr">string</span>
    <span class="na">info</span><span class="p">:</span> <span class="kr">string</span>
    <span class="na">infoBg</span><span class="p">:</span> <span class="kr">string</span>
    <span class="na">danger</span><span class="p">:</span> <span class="kr">string</span>
    <span class="na">dangerBg</span><span class="p">:</span> <span class="kr">string</span>
  <span class="p">},</span>
<span class="p">};</span>

<span class="k">export</span> <span class="kd">type</span> <span class="nx">ColorThemeName</span> <span class="o">=</span> <span class="k">typeof</span> <span class="nx">colorThemeNames</span><span class="p">[</span><span class="kr">number</span><span class="p">];</span>

<span class="cm">/**
 * Type guard for ColorThemeName
 *
 * @param {unknown} val
 * @return {*}  {val is ColorThemeName}
 */</span>
<span class="k">export</span> <span class="kd">const</span> <span class="nx">isColorThemeName</span> <span class="o">=</span> <span class="p">(</span><span class="nx">val</span><span class="p">:</span> <span class="nx">unknown</span><span class="p">):</span> <span class="nx">val</span> <span class="k">is</span> <span class="nx">ColorThemeName</span> <span class="o">=&gt;</span> <span class="p">(</span>
  <span class="nx">colorThemeNames</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="nx">val</span> <span class="k">as</span> <span class="nx">ColorThemeName</span><span class="p">)</span>
<span class="p">);</span>

</code></pre>

</div>



<p>Also we need to modify <code>DefaultTheme</code> type in <code>styled.d.ts</code> like this.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="c1">// styled.d.ts</span>

<span class="k">import</span> <span class="dl">'</span><span class="s1">styled-components</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">ColorThemeStyle</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./types/colorTheme</span><span class="dl">'</span><span class="p">;</span>

<span class="kr">declare</span> <span class="kr">module</span> <span class="dl">'</span><span class="s1">styled-components</span><span class="dl">'</span> <span class="p">{</span>
  <span class="k">export</span> <span class="kr">interface</span> <span class="nx">DefaultTheme</span> <span class="kd">extends</span> <span class="nx">ColorThemeStyle</span> <span class="p">{}</span>
<span class="p">}</span>
</code></pre>

</div>



<p>It's convenient to create variables for the colors we will use.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="c1">// const/styles/colors.tsx</span>

<span class="k">export</span> <span class="kd">const</span> <span class="nx">dryadBark</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">#37352f</span><span class="dl">'</span><span class="p">;</span> <span class="c1">// light theme string color</span>
<span class="k">export</span> <span class="kd">const</span> <span class="nx">white</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">#ffffff</span><span class="dl">'</span><span class="p">;</span> <span class="c1">// light theme component color</span>
<span class="k">export</span> <span class="kd">const</span> <span class="nx">errigalWhite</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">#f6f6f9</span><span class="dl">'</span><span class="p">;</span> <span class="c1">// light theme background color</span>
<span class="k">export</span> <span class="kd">const</span> <span class="nx">gainsboro</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">#d9d9d9</span><span class="dl">'</span><span class="p">;</span> <span class="c1">// light theme border color</span>
<span class="k">export</span> <span class="kd">const</span> <span class="nx">coralRed</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">#f93e3d</span><span class="dl">'</span><span class="p">;</span> <span class="c1">// common danger color</span>
<span class="k">export</span> <span class="kd">const</span> <span class="nx">translucentUnicorn</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">#fcecee</span><span class="dl">'</span><span class="p">;</span>
<span class="k">export</span> <span class="kd">const</span> <span class="nx">softPetals</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">#e9f6ef</span><span class="dl">'</span><span class="p">;</span>
<span class="k">export</span> <span class="kd">const</span> <span class="nx">vegetation</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">#48cd90</span><span class="dl">'</span><span class="p">;</span> <span class="c1">// common info color</span>
<span class="k">export</span> <span class="kd">const</span> <span class="nx">stonewallGrey</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">#c3c2c1</span><span class="dl">'</span><span class="p">;</span>
<span class="k">export</span> <span class="kd">const</span> <span class="nx">astrograniteDebris</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">#3b414a</span><span class="dl">'</span><span class="p">;</span> <span class="c1">// dark theme border color</span>
<span class="k">export</span> <span class="kd">const</span> <span class="nx">aswadBlack</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">#141519</span><span class="dl">'</span><span class="p">;</span> <span class="c1">// dark theme background color</span>
<span class="k">export</span> <span class="kd">const</span> <span class="nx">washedBlack</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">#202528</span><span class="dl">'</span><span class="p">;</span> <span class="c1">// dark theme component background color</span>

</code></pre>

</div>



<p>(I used <a href="https://github.com/meodai/color-names">this</a> library to name these variables.)</p>

<p>Then declare color theme objects, default theme.<br>
<code>config/styles/colorTheme.ts</code><br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">ColorThemeStyle</span><span class="p">,</span> <span class="nx">ColorThemeName</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">../../types/colorTheme</span><span class="dl">'</span><span class="p">;</span>

<span class="c1">// colors</span>
<span class="k">import</span> <span class="p">{</span>
  <span class="nx">dryadBark</span><span class="p">,</span>
  <span class="nx">white</span><span class="p">,</span>
  <span class="nx">errigalWhite</span><span class="p">,</span>
  <span class="nx">gainsboro</span><span class="p">,</span>
  <span class="nx">coralRed</span><span class="p">,</span>
  <span class="nx">vegetation</span><span class="p">,</span>
  <span class="nx">astrograniteDebris</span><span class="p">,</span>
  <span class="nx">aswadBlack</span><span class="p">,</span>
  <span class="nx">washedBlack</span><span class="p">,</span>
  <span class="nx">softPetals</span><span class="p">,</span>
  <span class="nx">translucentUnicorn</span><span class="p">,</span>
<span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">../../const/styles/colors</span><span class="dl">'</span><span class="p">;</span>

<span class="k">export</span> <span class="kd">const</span> <span class="nx">defaultColorThemeName</span><span class="p">:</span> <span class="nx">ColorThemeName</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">light</span><span class="dl">'</span><span class="p">;</span>

<span class="k">export</span> <span class="kd">const</span> <span class="nx">lightTheme</span><span class="p">:</span> <span class="nx">ColorThemeStyle</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">colors</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">text</span><span class="p">:</span> <span class="nx">dryadBark</span><span class="p">,</span>
    <span class="na">background</span><span class="p">:</span> <span class="nx">errigalWhite</span><span class="p">,</span>
    <span class="na">componentBackground</span><span class="p">:</span> <span class="nx">white</span><span class="p">,</span>
    <span class="na">border</span><span class="p">:</span> <span class="nx">gainsboro</span><span class="p">,</span>
    <span class="na">info</span><span class="p">:</span> <span class="nx">vegetation</span><span class="p">,</span>
    <span class="na">infoBg</span><span class="p">:</span> <span class="nx">softPetals</span><span class="p">,</span>
    <span class="na">danger</span><span class="p">:</span> <span class="nx">coralRed</span><span class="p">,</span>
    <span class="na">dangerBg</span><span class="p">:</span> <span class="nx">translucentUnicorn</span><span class="p">,</span>
  <span class="p">},</span>
<span class="p">};</span>

<span class="k">export</span> <span class="kd">const</span> <span class="nx">darkTheme</span><span class="p">:</span> <span class="nx">ColorThemeStyle</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">colors</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">text</span><span class="p">:</span> <span class="nx">white</span><span class="p">,</span>
    <span class="na">background</span><span class="p">:</span> <span class="nx">aswadBlack</span><span class="p">,</span>
    <span class="na">componentBackground</span><span class="p">:</span> <span class="nx">washedBlack</span><span class="p">,</span>
    <span class="na">border</span><span class="p">:</span> <span class="nx">astrograniteDebris</span><span class="p">,</span>
    <span class="na">info</span><span class="p">:</span> <span class="nx">vegetation</span><span class="p">,</span>
    <span class="na">infoBg</span><span class="p">:</span> <span class="nx">softPetals</span><span class="p">,</span>
    <span class="na">danger</span><span class="p">:</span> <span class="nx">coralRed</span><span class="p">,</span>
    <span class="na">dangerBg</span><span class="p">:</span> <span class="nx">translucentUnicorn</span><span class="p">,</span>
  <span class="p">},</span>
<span class="p">};</span>

<span class="k">export</span> <span class="kd">const</span> <span class="nx">themeNameStyleMap</span><span class="p">:</span> <span class="p">{</span> <span class="p">[</span><span class="nx">key</span> <span class="k">in</span> <span class="nx">ColorThemeName</span><span class="p">]:</span> <span class="nx">ColorThemeStyle</span> <span class="p">}</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">light</span><span class="p">:</span> <span class="nx">lightTheme</span><span class="p">,</span>
  <span class="na">dark</span><span class="p">:</span> <span class="nx">darkTheme</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">export</span> <span class="kd">const</span> <span class="nx">defaultColorThemeStyle</span> <span class="o">=</span> <span class="nx">themeNameStyleMap</span><span class="p">[</span><span class="nx">defaultColorThemeName</span><span class="p">];</span>

</code></pre>

</div>



<h3>
  
  
  Set up Redux Toolkit
</h3>

<p>The state for dark mode must be managed globally. So let's use Redux Toolkit to manage global state.<br>
We are going to create <code>colorThemeSlice</code>, typed <code>useDispatch</code>, typed <code>useSelector</code> and configure <code>store</code>.</p>

<p><code>stores/slices/colorThemeSlice.ts</code><br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">createSlice</span><span class="p">,</span> <span class="nx">PayloadAction</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@reduxjs/toolkit</span><span class="dl">'</span><span class="p">;</span>

<span class="c1">// "type" is needed. If no "type", circular dependency error arise</span>
<span class="c1">// https://stackoverflow.com/questions/63923025/how-to-fix-circular-dependencies-of-slices-with-the-rootstate</span>
<span class="k">import</span> <span class="kd">type</span> <span class="p">{</span> <span class="nx">RootState</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">../store</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">ColorThemeName</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">../../types/colorTheme</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">defaultColorThemeName</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">../../const/colorTheme</span><span class="dl">'</span><span class="p">;</span>

<span class="kd">type</span> <span class="nx">ColorThemeState</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">theme</span><span class="p">:</span> <span class="nx">ColorThemeName</span>
<span class="p">};</span>

<span class="kd">const</span> <span class="nx">initialState</span><span class="p">:</span> <span class="nx">ColorThemeState</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">theme</span><span class="p">:</span> <span class="nx">defaultColorThemeName</span><span class="p">,</span>
<span class="p">};</span>

<span class="kd">const</span> <span class="nx">colorThemeSlice</span> <span class="o">=</span> <span class="nx">createSlice</span><span class="p">({</span>
  <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">colorTheme</span><span class="dl">'</span><span class="p">,</span>
  <span class="nx">initialState</span><span class="p">,</span>
  <span class="na">reducers</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">updateColorTheme</span><span class="p">:</span> <span class="p">(</span><span class="nx">state</span><span class="p">,</span> <span class="na">action</span><span class="p">:</span> <span class="nx">PayloadAction</span><span class="o">&lt;</span><span class="nx">ColorThemeName</span><span class="o">&gt;</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">state</span><span class="p">.</span><span class="nx">theme</span> <span class="o">=</span> <span class="nx">action</span><span class="p">.</span><span class="nx">payload</span><span class="p">;</span>
    <span class="p">},</span>
  <span class="p">},</span>
<span class="p">});</span>

<span class="c1">// selectors</span>
<span class="k">export</span> <span class="kd">const</span> <span class="nx">selectColorTheme</span> <span class="o">=</span> <span class="p">(</span><span class="nx">state</span><span class="p">:</span> <span class="nx">RootState</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">state</span><span class="p">.</span><span class="nx">colorTheme</span><span class="p">.</span><span class="nx">theme</span><span class="p">;</span>
<span class="k">export</span> <span class="k">default</span> <span class="nx">colorThemeSlice</span><span class="p">.</span><span class="nx">reducer</span><span class="p">;</span>

<span class="c1">// actions</span>
<span class="k">export</span> <span class="kd">const</span> <span class="p">{</span>
  <span class="nx">updateColorTheme</span><span class="p">,</span>
<span class="p">}</span> <span class="o">=</span> <span class="nx">colorThemeSlice</span><span class="p">.</span><span class="nx">actions</span><span class="p">;</span>

</code></pre>

</div>



<p><code>stores/store.ts</code><br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="c1">// https://redux-toolkit.js.org/tutorials/typescript</span>

<span class="k">import</span> <span class="p">{</span> <span class="nx">configureStore</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@reduxjs/toolkit</span><span class="dl">'</span><span class="p">;</span>

<span class="c1">// reducers</span>
<span class="k">import</span> <span class="nx">colorThemeReducer</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./slices/colorThemeSlice</span><span class="dl">'</span><span class="p">;</span>

<span class="k">export</span> <span class="kd">const</span> <span class="nx">store</span> <span class="o">=</span> <span class="nx">configureStore</span><span class="p">({</span>
  <span class="na">reducer</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">colorTheme</span><span class="p">:</span> <span class="nx">colorThemeReducer</span><span class="p">,</span>
  <span class="p">},</span>
<span class="p">});</span>

<span class="k">export</span> <span class="kd">type</span> <span class="nx">RootState</span> <span class="o">=</span> <span class="nx">ReturnType</span><span class="o">&lt;</span><span class="k">typeof</span> <span class="nx">store</span><span class="p">.</span><span class="nx">getState</span><span class="o">&gt;</span><span class="p">;</span>

<span class="k">export</span> <span class="kd">type</span> <span class="nx">AppDispatch</span> <span class="o">=</span> <span class="k">typeof</span> <span class="nx">store</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">;</span>

</code></pre>

</div>



<p><code>stores/hooks.ts</code><br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="c1">// https://redux-toolkit.js.org/tutorials/typescript</span>

<span class="k">import</span> <span class="p">{</span> <span class="nx">useDispatch</span><span class="p">,</span> <span class="nx">useSelector</span><span class="p">,</span> <span class="nx">TypedUseSelectorHook</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react-redux</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">RootState</span><span class="p">,</span> <span class="nx">AppDispatch</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./store</span><span class="dl">'</span><span class="p">;</span>

<span class="k">export</span> <span class="kd">const</span> <span class="nx">useAppDispatch</span><span class="p">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="nx">AppDispatch</span> <span class="o">=</span> <span class="nx">useDispatch</span><span class="p">;</span>

<span class="k">export</span> <span class="kd">const</span> <span class="nx">useAppSelector</span><span class="p">:</span> <span class="nx">TypedUseSelectorHook</span><span class="o">&lt;</span><span class="nx">RootState</span><span class="o">&gt;</span> <span class="o">=</span> <span class="nx">useSelector</span><span class="p">;</span>

</code></pre>

</div>



<h3>
  
  
  Utility functions to handle color theme cookie
</h3>

<p>Dark mode must persists even when the page is refreshed. To achieve this, we are going to use cookie.</p>

<p><code>utils/cookie/colorTheme.ts</code><br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">getCookie</span><span class="p">,</span> <span class="nx">setCookie</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">cookies-next</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">OptionsType</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">cookies-next/lib/types</span><span class="dl">'</span><span class="p">;</span>

<span class="k">import</span> <span class="p">{</span> <span class="nx">colorThemeCookieName</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">../../const/colorTheme</span><span class="dl">'</span><span class="p">;</span>

<span class="k">import</span> <span class="p">{</span> <span class="nx">ColorThemeName</span><span class="p">,</span> <span class="nx">isColorThemeName</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">../../types/colorTheme</span><span class="dl">'</span><span class="p">;</span>

<span class="cm">/**
 * Set color theme cookie to persist color theme config
 *
 * @param {ColorThemeName} value
 * @param {OptionsType} [options]
 */</span>
<span class="k">export</span> <span class="kd">const</span> <span class="nx">setColorThemeCookie</span> <span class="o">=</span> <span class="p">(</span><span class="nx">value</span><span class="p">:</span> <span class="nx">ColorThemeName</span><span class="p">,</span> <span class="nx">options</span><span class="p">?:</span> <span class="nx">OptionsType</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">setCookie</span><span class="p">(</span><span class="nx">colorThemeCookieName</span><span class="p">,</span> <span class="nx">value</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
<span class="p">};</span>

<span class="cm">/**
 *
 *
 * @param {OptionsType} [options]
 * @return {string}  {string}
 */</span>
<span class="k">export</span> <span class="kd">const</span> <span class="nx">getColorThemeCookie</span> <span class="o">=</span> <span class="p">(</span><span class="nx">options</span><span class="p">?:</span> <span class="nx">OptionsType</span><span class="p">):</span> <span class="kr">string</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">colorThemeCookie</span> <span class="o">=</span> <span class="nx">getCookie</span><span class="p">(</span><span class="nx">colorThemeCookieName</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
  <span class="k">return</span> <span class="nx">isColorThemeName</span><span class="p">(</span><span class="nx">colorThemeCookie</span><span class="p">)</span> <span class="p">?</span> <span class="nx">colorThemeCookie</span> <span class="p">:</span> <span class="dl">''</span><span class="p">;</span>
<span class="p">};</span>

</code></pre>

</div>



<h3>
  
  
  Implement useColorTheme custom hook
</h3>

<p>In the implementation, we'll need to switch color themes or retrieve the current color theme. Let's put those logics into a custom hook so that they can be called in every components.</p>

<p><code>hooks/useColorTheme.ts</code><br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">defaultColorThemeName</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">../const/colorTheme</span><span class="dl">'</span><span class="p">;</span>

<span class="k">import</span> <span class="p">{</span> <span class="nx">getColorThemeCookie</span><span class="p">,</span> <span class="nx">setColorThemeCookie</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">../utils/cookie/colorTheme</span><span class="dl">'</span><span class="p">;</span>

<span class="k">import</span> <span class="p">{</span> <span class="nx">useAppDispatch</span><span class="p">,</span> <span class="nx">useAppSelector</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">../stores/hooks</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">selectColorTheme</span><span class="p">,</span> <span class="nx">updateColorTheme</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">../stores/slices/colorThemeSlice</span><span class="dl">'</span><span class="p">;</span>

<span class="k">import</span> <span class="p">{</span> <span class="nx">themeNameStyleMap</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">../config/styles/colorThemes</span><span class="dl">'</span><span class="p">;</span>

<span class="k">import</span> <span class="p">{</span> <span class="nx">ColorThemeName</span><span class="p">,</span> <span class="nx">ColorThemeStyle</span><span class="p">,</span> <span class="nx">isColorThemeName</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">../types/colorTheme</span><span class="dl">'</span><span class="p">;</span>

<span class="cm">/**
 * Custom hook for handling color themes
 *
 */</span>
<span class="kd">const</span> <span class="nx">useColorTheme</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">dispatch</span> <span class="o">=</span> <span class="nx">useAppDispatch</span><span class="p">();</span>
  <span class="kd">const</span> <span class="nx">currentColorTheme</span> <span class="o">=</span> <span class="nx">useAppSelector</span><span class="p">(</span><span class="nx">selectColorTheme</span><span class="p">);</span>

  <span class="cm">/**
   * Set color theme cookie and state
   *
   * @param {ColorThemeName} colorThemeName
   */</span>
  <span class="kd">const</span> <span class="nx">setColorTheme</span> <span class="o">=</span> <span class="p">(</span><span class="na">colorThemeName</span><span class="p">:</span> <span class="nx">ColorThemeName</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">setColorThemeCookie</span><span class="p">(</span><span class="nx">colorThemeName</span><span class="p">);</span>
    <span class="nx">dispatch</span><span class="p">(</span><span class="nx">updateColorTheme</span><span class="p">(</span><span class="nx">colorThemeName</span><span class="p">));</span>
  <span class="p">};</span>

  <span class="cm">/**
   * Initialize color theme cookie and state
   *
   * @return {void}
   */</span>
  <span class="kd">const</span> <span class="nx">initColorTheme</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">currentColorThemeCookie</span> <span class="o">=</span> <span class="nx">getColorThemeCookie</span><span class="p">();</span>

    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">currentColorThemeCookie</span> <span class="o">||</span> <span class="o">!</span><span class="nx">isColorThemeName</span><span class="p">(</span><span class="nx">currentColorThemeCookie</span><span class="p">))</span> <span class="p">{</span>
      <span class="nx">setColorTheme</span><span class="p">(</span><span class="nx">defaultColorThemeName</span><span class="p">);</span>
      <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">dispatch</span><span class="p">(</span><span class="nx">updateColorTheme</span><span class="p">(</span><span class="nx">currentColorThemeCookie</span><span class="p">));</span>
  <span class="p">};</span>

  <span class="cm">/**
   *
   *
   * @return {*} ColorTheme
   */</span>
  <span class="kd">const</span> <span class="nx">getCurrentColorThemeState</span> <span class="o">=</span> <span class="p">():</span> <span class="nx">ColorTheme</span> <span class="o">=&gt;</span> <span class="p">(</span>
    <span class="nx">currentColorThemeState</span>
  <span class="p">);</span>

  <span class="cm">/**
   *
   *
   * @return {*}  {ColorThemeStyle}
   */</span>
  <span class="kd">const</span> <span class="nx">getCurrentColorThemeStyle</span> <span class="o">=</span> <span class="p">():</span> <span class="nx">ColorThemeStyle</span> <span class="o">=&gt;</span> <span class="p">(</span>
    <span class="nx">themeNameStyleMap</span><span class="p">[</span><span class="nx">currentColorTheme</span><span class="p">]</span>
  <span class="p">);</span>

  <span class="k">return</span> <span class="p">{</span>
    <span class="nx">setColorTheme</span><span class="p">,</span>
    <span class="nx">initColorTheme</span><span class="p">,</span>
    <span class="nx">getCurrentColorThemeState</span><span class="p">,</span>
    <span class="nx">getCurrentColorThemeStyle</span><span class="p">,</span>
  <span class="p">};</span>
<span class="p">};</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">useColorTheme</span><span class="p">;</span>

</code></pre>

</div>



<h3>
  
  
  Configure RTK and Styled Components in _app.tsx
</h3>

<p>We've implemented so many functions and logic up to this point, but as it stands, we can't use them yet.<br>
Let's edit _app.tsx to make sure Redux Toolkit and Styled Components are available for use.</p>

<p><code>pages/_app.tsx</code><br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">useEffect</span><span class="p">,</span> <span class="nx">ReactElement</span><span class="p">,</span> <span class="nx">ReactNode</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react</span><span class="dl">'</span><span class="p">;</span>

<span class="c1">// Next</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">NextPage</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">next</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">Router</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">next/router</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="kd">type</span> <span class="p">{</span> <span class="nx">AppProps</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">next/app</span><span class="dl">'</span><span class="p">;</span>

<span class="c1">// Libraries</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">Provider</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react-redux</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">ThemeProvider</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">styled-components</span><span class="dl">'</span><span class="p">;</span>

<span class="k">import</span> <span class="p">{</span> <span class="nx">store</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">../stores/store</span><span class="dl">'</span><span class="p">;</span>

<span class="k">import</span> <span class="nx">GlobalStyle</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">../components/globalstyles</span><span class="dl">'</span><span class="p">;</span>

<span class="k">import</span> <span class="nx">useColorTheme</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">../hooks/useColorTheme</span><span class="dl">'</span><span class="p">;</span>

<span class="c1">// Layout configuration doc</span>
<span class="c1">// https://nextjs.org/docs/pages/building-your-application/routing/pages-and-layouts#with-typescript</span>

<span class="k">export</span> <span class="kd">type</span> <span class="nx">NextPageWithLayout</span><span class="o">&lt;</span><span class="nx">P</span> <span class="o">=</span> <span class="p">{},</span> <span class="nx">IP</span> <span class="o">=</span> <span class="nx">P</span><span class="o">&gt;</span> <span class="o">=</span> <span class="nx">NextPage</span><span class="o">&lt;</span><span class="nx">P</span><span class="p">,</span> <span class="nx">IP</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="p">{</span>
  <span class="nx">getLayout</span><span class="p">?:</span> <span class="p">(</span><span class="na">page</span><span class="p">:</span> <span class="nx">ReactElement</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">ReactNode</span><span class="p">;</span>
<span class="p">};</span>

<span class="kd">type</span> <span class="nx">AppPropsWithLayout</span> <span class="o">=</span> <span class="nx">AppProps</span> <span class="o">&amp;</span> <span class="p">{</span>
  <span class="na">Component</span><span class="p">:</span> <span class="nx">NextPageWithLayout</span>
  <span class="na">router</span><span class="p">:</span> <span class="nx">Router</span> <span class="c1">// Error if this property doesn't exist</span>
<span class="p">};</span>

<span class="cm">/**
 *
 *
 * @param {AppPropsWithLayout} { Component, pageProps }
 * @return {*} JSX.Element
 */</span>
<span class="kd">const</span> <span class="nx">WithThemeProviderComponent</span> <span class="o">=</span> <span class="p">({</span> <span class="nx">Component</span><span class="p">,</span> <span class="nx">pageProps</span> <span class="p">}:</span> <span class="nx">AppPropsWithLayout</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="p">{</span> <span class="nx">initColorTheme</span><span class="p">,</span> <span class="nx">getCurrentColorThemeStyle</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">useColorTheme</span><span class="p">();</span>

  <span class="nx">useEffect</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">initColorTheme</span><span class="p">();</span>
  <span class="p">},</span> <span class="p">[]);</span>

  <span class="k">return</span> <span class="p">(</span>
    <span class="o">&lt;</span><span class="nx">ThemeProvider</span> <span class="nx">theme</span><span class="o">=</span><span class="p">{</span><span class="nx">getCurrentColorThemeStyle</span><span class="p">()}</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="nx">GlobalStyle</span> <span class="o">/&gt;</span>
      <span class="o">&lt;</span><span class="nx">Component</span> <span class="p">{...</span><span class="nx">pageProps</span><span class="p">}</span> <span class="sr">/</span><span class="err">&gt;
</span>    <span class="o">&lt;</span><span class="sr">/ThemeProvider</span><span class="err">&gt;
</span>  <span class="p">);</span>
<span class="p">};</span>

<span class="kd">const</span> <span class="nx">App</span> <span class="o">=</span> <span class="p">({</span> <span class="nx">Component</span><span class="p">,</span> <span class="nx">pageProps</span><span class="p">,</span> <span class="nx">router</span> <span class="p">}:</span> <span class="nx">AppPropsWithLayout</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">getLayout</span> <span class="o">=</span> <span class="nx">Component</span><span class="p">.</span><span class="nx">getLayout</span> <span class="o">??</span> <span class="p">((</span><span class="nx">page</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">page</span><span class="p">);</span>

  <span class="k">return</span> <span class="p">(</span>
    <span class="o">&lt;</span><span class="nx">Provider</span> <span class="nx">store</span><span class="o">=</span><span class="p">{</span><span class="nx">store</span><span class="p">}</span><span class="o">&gt;</span>
      <span class="p">{</span><span class="nx">getLayout</span><span class="p">(</span>
        <span class="o">&lt;</span><span class="nx">WithThemeProviderComponent</span>
          <span class="nx">Component</span><span class="o">=</span><span class="p">{</span><span class="nx">Component</span><span class="p">}</span>
          <span class="nx">pageProps</span><span class="o">=</span><span class="p">{</span><span class="nx">pageProps</span><span class="p">}</span>
          <span class="nx">router</span><span class="o">=</span><span class="p">{</span><span class="nx">router</span><span class="p">}</span>
        <span class="sr">/&gt;</span><span class="err">,
</span>      <span class="p">)}</span>
    <span class="o">&lt;</span><span class="sr">/Provider</span><span class="err">&gt;
</span>  <span class="p">);</span>
<span class="p">};</span>
<span class="k">export</span> <span class="k">default</span> <span class="nx">App</span><span class="p">;</span>

</code></pre>

</div>



<h2>
  
  
  Let's implement dark mode toggle switch
</h2>

<p>With the implementation up to this point, we've completed the necessary preparations for switching the color theme.<br>
Now, let's use <code>useColorTheme</code> to implement <code>DarkModeToggleSwitch</code> component (we'll skip detailed styling for now).</p>

<p><code>globalstyles.tsx</code><br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="p">...</span>
  <span class="nx">body</span> <span class="p">{</span>
    <span class="p">...</span>
    <span class="nx">background</span><span class="o">-</span><span class="nx">color</span><span class="p">:</span> <span class="nx">$</span><span class="p">{({</span> <span class="nx">theme</span> <span class="p">})</span> <span class="o">=&gt;</span> <span class="nx">theme</span><span class="p">.</span><span class="nx">colors</span><span class="p">.</span><span class="nx">background</span><span class="p">};</span>
    <span class="nl">color</span><span class="p">:</span> <span class="nx">$</span><span class="p">{({</span> <span class="nx">theme</span> <span class="p">})</span> <span class="o">=&gt;</span> <span class="nx">theme</span><span class="p">.</span><span class="nx">colors</span><span class="p">.</span><span class="nx">text</span><span class="p">};</span>
    <span class="p">...</span>
  <span class="p">}</span>

<span class="p">...</span>
</code></pre>

</div>



<p><code>components/DarkModeToggleSwitch.tsx</code><br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">useColorTheme</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">../../../hooks/useColorTheme</span><span class="dl">'</span>


<span class="cm">/**
 * Dark mode &lt;-&gt; light mode toggle switch
 * Update cookie value and global state
 *
 * @return {*} JSX.Element
 */</span>
<span class="kd">const</span> <span class="nx">DarkModeToggleSwitch</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="p">{</span> <span class="nx">setColorTheme</span><span class="p">,</span> <span class="nx">getCurrentColorThemeState</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">useColorTheme</span><span class="p">()</span>

  <span class="kd">const</span> <span class="nx">currentColorTheme</span> <span class="o">=</span> <span class="nx">getCurrentColorThemeState</span><span class="p">()</span>

  <span class="kd">const</span> <span class="nx">isDark</span> <span class="o">=</span> <span class="nx">currentColorTheme</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">dark</span><span class="dl">'</span>

  <span class="kd">const</span> <span class="nx">toggleDarkTheme</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">isDark</span> <span class="p">?</span> <span class="nx">setColorTheme</span><span class="p">(</span><span class="dl">'</span><span class="s1">light</span><span class="dl">'</span><span class="p">)</span> <span class="p">:</span> <span class="nx">setColorTheme</span><span class="p">(</span><span class="dl">'</span><span class="s1">dark</span><span class="dl">'</span><span class="p">)</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="p">(</span>
    <span class="o">&lt;&gt;</span>
      <span class="p">...</span>
      <span class="o">&lt;</span><span class="nx">input</span> <span class="kd">type</span><span class="o">=</span><span class="dl">'</span><span class="s1">checkbox</span><span class="dl">'</span> <span class="nx">checked</span><span class="o">=</span><span class="p">{</span><span class="nx">isDark</span><span class="p">}</span> <span class="nx">onChange</span><span class="o">=</span><span class="p">{</span><span class="nx">toggleDarkTheme</span><span class="p">}</span> <span class="sr">/</span><span class="err">&gt;
</span>      <span class="p">...</span>
    <span class="o">&lt;</span><span class="sr">/</span><span class="err">&gt;
</span>  <span class="p">)</span>
<span class="p">}</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">DarkModeToggleSwitch</span>
</code></pre>

</div>






<p>That's all.<br>
How was it? I hope this article was helpful for you.</p>

<p>There are many ways to implement color theme switching besides this article. If you have any recommended methods or articles, please share them in the comments and let me know!</p>

<p>And if you found this article helpful, please share it on social media!</p>

 </details> 
 <hr /> 

 #### - [DynamoDB Streams EventBridge Pipes Multiple Items](https://dev.to/aws-builders/dynamodb-streams-eventbridge-pipes-multiple-items-4657) 
 <details><summary>Article</summary> <p>I've written a few articles lately on EventBridge Pipes and specifically around using them with DynamoDB Streams. I've written about <a href="https://www.binaryheap.com/dynamodb-eventbridge-pipes-enrichment/">Enrichment</a>. And I've written about just straight <a href="https://www.binaryheap.com/streaming-aws-dynamodb-to-a-lambda-via-eventbridge-pipes/">Streaming</a>. I believe that using EventBridge Pipes plays a nice part in a Serverless, Event-Driven approach. So in this article, I want to explore Streaming DynamoDB to EventBridge Pipes with multiple items in one table.</p>

<p>Several of the comments I received about <a href="https://www.binaryheap.com/dynamodb-eventbridge-pipes-enrichment/">Streaming DynamoDB to EventBridge Pipes</a> were around, "What if I have multiple item collections in the same table?". I intend to show a pattern for handling that exact problem in this article. At the bottom, you'll find a working code sample that you can deploy and build on top of. I've used this exact setup in production, so rest assured that this is a great base to start from.</p>

<h2>
  
  
  Architecture
</h2>

<p>Let's start with defining the setup that I'll be walking through.</p>

<ul>
<li>  DynamoDB Table with 2 Item Types

<ul>
<li>  Patient</li>
<li>  Address</li>
</ul>


</li>
<li>  DynamoDB Stream connected to an EventBridge Pipe</li>
<li>  EB Pipe will

<ul>
<li>  Filter</li>
<li>  Enrich</li>
<li>  Put into the EventBridge Default Bus</li>
</ul>


</li>
<li>  EB Rules carved out for

<ul>
<li>  Lambda Handler for Patient</li>
<li>  Lambda Handler for Address</li>
</ul>


</li>
</ul>

<p><a href="https://res.cloudinary.com/practicaldev/image/fetch/s--TwVlHZ52--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_800/https://www.binaryheap.com/wp-content/uploads/2023/09/Multi-Arch.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--TwVlHZ52--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_800/https://www.binaryheap.com/wp-content/uploads/2023/09/Multi-Arch.png" alt="EventBridge Pipe Stream" width="800" height="256"></a></p>

<h2>
  
  
  Step Through the Code
</h2>

<h3>
  
  
  DynamoDB Table
</h3>

<p>The DynamoDB Table I'm working from is going to contain multiple item types. This can be described as Single-Table design, Multi-Item Collection Design or whatever you like. The point is, that DynamoDB is great at storing things that are related in the same table. I'm defining an <code>id</code> field as the Partition Key and then <code>sk</code> as the Range Key.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="k">this</span><span class="p">.</span><span class="nx">_table</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Table</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">id</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">billingMode</span><span class="p">:</span> <span class="nx">BillingMode</span><span class="p">.</span><span class="nx">PAY_PER_REQUEST</span><span class="p">,</span>
    <span class="na">removalPolicy</span><span class="p">:</span> <span class="nx">RemovalPolicy</span><span class="p">.</span><span class="nx">DESTROY</span><span class="p">,</span>
    <span class="na">partitionKey</span><span class="p">:</span> <span class="p">{</span> <span class="na">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">id</span><span class="dl">"</span><span class="p">,</span> <span class="na">type</span><span class="p">:</span> <span class="nx">AttributeType</span><span class="p">.</span><span class="nx">STRING</span> <span class="p">},</span>
    <span class="na">sortKey</span><span class="p">:</span> <span class="p">{</span> <span class="na">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">sk</span><span class="dl">"</span><span class="p">,</span> <span class="na">type</span><span class="p">:</span> <span class="nx">AttributeType</span><span class="p">.</span><span class="nx">STRING</span> <span class="p">},</span>
    <span class="na">tableName</span><span class="p">:</span> <span class="s2">`Patients`</span><span class="p">,</span>
    <span class="na">encryption</span><span class="p">:</span> <span class="nx">TableEncryption</span><span class="p">.</span><span class="nx">CUSTOMER_MANAGED</span><span class="p">,</span>
    <span class="na">encryptionKey</span><span class="p">:</span> <span class="nx">props</span><span class="p">.</span><span class="nx">key</span><span class="p">,</span>
    <span class="na">stream</span><span class="p">:</span> <span class="nx">StreamViewType</span><span class="p">.</span><span class="nx">NEW_AND_OLD_IMAGES</span><span class="p">,</span>
<span class="p">});</span>
</code></pre>

</div>



<p>Notice as well that I'm defining a <code>stream</code> that will propagate changes with New and Old images attached to the change record. This will be useful as I get into the Pipe definition.</p>

<p>A Patient will look like this:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"PATIENT#1"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"sk"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ADDRESS#1"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"address"</span><span class="p">:</span><span class="w"> </span><span class="s2">"123 Some City, Some State USAA"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"addressId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"itemType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Address"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"patientId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

</div>



<p>And an Address like this:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"PATIENT#1"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"sk"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ADDRESS#1"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"address"</span><span class="p">:</span><span class="w"> </span><span class="s2">"123 Some City, Some State USAA"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"addressId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"itemType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Address"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"patientId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

</div>



<p><a href="https://res.cloudinary.com/practicaldev/image/fetch/s--5qkpO-QE--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_800/https://www.binaryheap.com/wp-content/uploads/2023/09/db_records.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--5qkpO-QE--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_800/https://www.binaryheap.com/wp-content/uploads/2023/09/db_records.png" alt="Table Records" width="800" height="181"></a></p>

<h3>
  
  
  EventBridge Pipe
</h3>

<p>When Streaming DynamoDB to EventBridge Pipes, the Pipe is the central player in the design. In this scenario, I'm ignoring Deletes and only dealing with DynamoDB Modify and Insert change types.</p>

<h4>
  
  
  The Source
</h4>

<p>I want to first address the fact that your source component needs to have the proper IAM Permissions attached to read from the stream and decrypt the data.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="k">new</span> <span class="nx">PolicyDocument</span><span class="p">({</span>
    <span class="na">statements</span><span class="p">:</span> <span class="p">[</span>
        <span class="k">new</span> <span class="nx">PolicyStatement</span><span class="p">({</span>
            <span class="na">actions</span><span class="p">:</span> <span class="p">[</span>
                <span class="dl">"</span><span class="s2">dynamodb:DescribeStream</span><span class="dl">"</span><span class="p">,</span>
                <span class="dl">"</span><span class="s2">dynamodb:GetRecords</span><span class="dl">"</span><span class="p">,</span>
                <span class="dl">"</span><span class="s2">dynamodb:GetShardIterator</span><span class="dl">"</span><span class="p">,</span>
                <span class="dl">"</span><span class="s2">dynamodb:ListStreams</span><span class="dl">"</span><span class="p">,</span>
            <span class="p">],</span>
            <span class="na">effect</span><span class="p">:</span> <span class="nx">Effect</span><span class="p">.</span><span class="nx">ALLOW</span><span class="p">,</span>
            <span class="na">resources</span><span class="p">:</span> <span class="p">[</span><span class="nx">table</span><span class="p">.</span><span class="nx">tableStreamArn</span><span class="o">!</span><span class="p">],</span>
        <span class="p">}),</span>
        <span class="k">new</span> <span class="nx">PolicyStatement</span><span class="p">({</span>
            <span class="na">actions</span><span class="p">:</span> <span class="p">[</span>
                <span class="dl">"</span><span class="s2">kms:Decrypt</span><span class="dl">"</span><span class="p">,</span>
                <span class="dl">"</span><span class="s2">kms:DescribeKey</span><span class="dl">"</span><span class="p">,</span>
                <span class="dl">"</span><span class="s2">kms:Encrypt</span><span class="dl">"</span><span class="p">,</span>
                <span class="dl">"</span><span class="s2">kms:GenerateDataKey*</span><span class="dl">"</span><span class="p">,</span>
                <span class="dl">"</span><span class="s2">kms:ReEncrypt*</span><span class="dl">"</span><span class="p">,</span>
            <span class="p">],</span>
            <span class="na">resources</span><span class="p">:</span> <span class="p">[</span><span class="nx">key</span><span class="p">.</span><span class="nx">keyArn</span><span class="p">],</span>
            <span class="na">effect</span><span class="p">:</span> <span class="nx">Effect</span><span class="p">.</span><span class="nx">ALLOW</span><span class="p">,</span>
        <span class="p">}),</span>
    <span class="p">],</span>
<span class="p">});</span>
</code></pre>

</div>



<p>The next step is to configure the stream reader. I want to process 1 record at a time in addition to filtering in only the Modify and Inserts as described above.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="k">return</span> <span class="p">{</span>
    <span class="na">dynamoDbStreamParameters</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">startingPosition</span><span class="p">:</span> <span class="dl">"</span><span class="s2">LATEST</span><span class="dl">"</span><span class="p">,</span>
        <span class="na">batchSize</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="na">filterCriteria</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">filters</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="na">pattern</span><span class="p">:</span> <span class="dl">'</span><span class="s1"> { "eventName": [ "MODIFY", "INSERT" ] }</span><span class="dl">'</span><span class="p">,</span>
            <span class="p">},</span>
        <span class="p">],</span>
    <span class="p">},</span>
<span class="p">};</span>
</code></pre>

</div>



<h4>
  
  
  The Enrichment
</h4>

<p>In this case, I want to simply strip out the DynamoDB parts of the source event down a raw <code>struct</code> in Golang that I can pass along into the EventBridge Bus. To do that, I'm going to use a Lambda function as part of the Pipe workflow.</p>

<p>The Lambda will be triggered as a Request/Response that makes this synchronous in the workflow.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="k">return</span> <span class="p">{</span>
    <span class="na">lambdaParameters</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">invocationType</span><span class="p">:</span> <span class="dl">"</span><span class="s2">REQUEST_RESPONSE</span><span class="dl">"</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="na">inputTemplate</span><span class="p">:</span> <span class="s2">``</span><span class="p">,</span>
<span class="p">};</span>
</code></pre>

</div>



<p>The Lambda itself handles the shaping of the Stream Record.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight go"><code><span class="k">func</span> <span class="n">Convert</span><span class="p">(</span><span class="n">r</span> <span class="o">*</span><span class="n">events</span><span class="o">.</span><span class="n">DynamoDBEventRecord</span><span class="p">)</span> <span class="p">(</span><span class="o">*</span><span class="n">CustomEvent</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="c">// the body of this function parses out the values</span>
    <span class="c">// and returns shaped record</span>
    <span class="k">if</span> <span class="n">itemType</span> <span class="o">==</span> <span class="s">"Patient"</span> <span class="p">{</span>
        <span class="n">i</span> <span class="o">:=</span> <span class="n">r</span><span class="o">.</span><span class="n">Change</span><span class="o">.</span><span class="n">NewImage</span><span class="p">[</span><span class="s">"id"</span><span class="p">]</span>
        <span class="n">n</span> <span class="o">:=</span> <span class="n">r</span><span class="o">.</span><span class="n">Change</span><span class="o">.</span><span class="n">NewImage</span><span class="p">[</span><span class="s">"name"</span><span class="p">]</span>
        <span class="n">t</span> <span class="o">:=</span> <span class="n">r</span><span class="o">.</span><span class="n">Change</span><span class="o">.</span><span class="n">NewImage</span><span class="p">[</span><span class="s">"itemType"</span><span class="p">]</span>
        <span class="n">s</span> <span class="o">:=</span> <span class="n">r</span><span class="o">.</span><span class="n">Change</span><span class="o">.</span><span class="n">NewImage</span><span class="p">[</span><span class="s">"sk"</span><span class="p">]</span>
        <span class="n">pid</span> <span class="o">:=</span> <span class="n">r</span><span class="o">.</span><span class="n">Change</span><span class="o">.</span><span class="n">NewImage</span><span class="p">[</span><span class="s">"patientId"</span><span class="p">]</span>

        <span class="n">change</span> <span class="o">:=</span> <span class="n">fmt</span><span class="o">.</span><span class="n">Sprintf</span><span class="p">(</span><span class="s">"Patient%s"</span><span class="p">,</span> <span class="n">strings</span><span class="o">.</span><span class="n">Title</span><span class="p">(</span><span class="n">strings</span><span class="o">.</span><span class="n">ToLower</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">EventName</span><span class="p">)))</span>
        <span class="k">return</span> <span class="o">&amp;</span><span class="n">CustomEvent</span><span class="p">{</span>
            <span class="n">EventType</span><span class="o">:</span>     <span class="n">change</span><span class="p">,</span>
            <span class="n">CorrelationId</span><span class="o">:</span> <span class="n">r</span><span class="o">.</span><span class="n">EventID</span><span class="p">,</span>
            <span class="n">Body</span><span class="o">:</span> <span class="o">&amp;</span><span class="n">ItemOne</span><span class="p">{</span>
                <span class="n">Id</span><span class="o">:</span>        <span class="n">i</span><span class="o">.</span><span class="n">String</span><span class="p">(),</span>
                <span class="n">Name</span><span class="o">:</span>      <span class="n">n</span><span class="o">.</span><span class="n">String</span><span class="p">(),</span>
                <span class="n">ItemType</span><span class="o">:</span>  <span class="n">t</span><span class="o">.</span><span class="n">String</span><span class="p">(),</span>
                <span class="n">Sk</span><span class="o">:</span>        <span class="n">s</span><span class="o">.</span><span class="n">String</span><span class="p">(),</span>
                <span class="n">PatientId</span><span class="o">:</span> <span class="n">pid</span><span class="o">.</span><span class="n">String</span><span class="p">(),</span>
            <span class="p">}},</span> <span class="no">nil</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="n">itemType</span> <span class="o">==</span> <span class="s">"Address"</span> <span class="p">{</span>
        <span class="n">i</span> <span class="o">:=</span> <span class="n">r</span><span class="o">.</span><span class="n">Change</span><span class="o">.</span><span class="n">NewImage</span><span class="p">[</span><span class="s">"id"</span><span class="p">]</span>
        <span class="n">n</span> <span class="o">:=</span> <span class="n">r</span><span class="o">.</span><span class="n">Change</span><span class="o">.</span><span class="n">NewImage</span><span class="p">[</span><span class="s">"address"</span><span class="p">]</span>
        <span class="n">t</span> <span class="o">:=</span> <span class="n">r</span><span class="o">.</span><span class="n">Change</span><span class="o">.</span><span class="n">NewImage</span><span class="p">[</span><span class="s">"itemType"</span><span class="p">]</span>
        <span class="n">s</span> <span class="o">:=</span> <span class="n">r</span><span class="o">.</span><span class="n">Change</span><span class="o">.</span><span class="n">NewImage</span><span class="p">[</span><span class="s">"sk"</span><span class="p">]</span>
        <span class="n">pid</span> <span class="o">:=</span> <span class="n">r</span><span class="o">.</span><span class="n">Change</span><span class="o">.</span><span class="n">NewImage</span><span class="p">[</span><span class="s">"patientId"</span><span class="p">]</span>
        <span class="n">aid</span> <span class="o">:=</span> <span class="n">r</span><span class="o">.</span><span class="n">Change</span><span class="o">.</span><span class="n">NewImage</span><span class="p">[</span><span class="s">"addressId"</span><span class="p">]</span>
        <span class="n">change</span> <span class="o">:=</span> <span class="n">fmt</span><span class="o">.</span><span class="n">Sprintf</span><span class="p">(</span><span class="s">"Address%s"</span><span class="p">,</span> <span class="n">strings</span><span class="o">.</span><span class="n">Title</span><span class="p">(</span><span class="n">strings</span><span class="o">.</span><span class="n">ToLower</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">EventName</span><span class="p">)))</span>
        <span class="k">return</span> <span class="o">&amp;</span><span class="n">CustomEvent</span><span class="p">{</span>
            <span class="n">EventType</span><span class="o">:</span>     <span class="n">change</span><span class="p">,</span>
            <span class="n">CorrelationId</span><span class="o">:</span> <span class="n">r</span><span class="o">.</span><span class="n">EventID</span><span class="p">,</span>
            <span class="n">Body</span><span class="o">:</span> <span class="o">&amp;</span><span class="n">ItemTwo</span><span class="p">{</span>
                <span class="n">Id</span><span class="o">:</span>        <span class="n">i</span><span class="o">.</span><span class="n">String</span><span class="p">(),</span>
                <span class="n">Address</span><span class="o">:</span>   <span class="n">n</span><span class="o">.</span><span class="n">String</span><span class="p">(),</span>
                <span class="n">ItemType</span><span class="o">:</span>  <span class="n">t</span><span class="o">.</span><span class="n">String</span><span class="p">(),</span>
                <span class="n">Sk</span><span class="o">:</span>        <span class="n">s</span><span class="o">.</span><span class="n">String</span><span class="p">(),</span>
                <span class="n">PatientId</span><span class="o">:</span> <span class="n">pid</span><span class="o">.</span><span class="n">String</span><span class="p">(),</span>
                <span class="n">AddressId</span><span class="o">:</span> <span class="n">aid</span><span class="o">.</span><span class="n">String</span><span class="p">(),</span>
            <span class="p">}},</span> <span class="no">nil</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>

</div>



<h4>
  
  
  The Target
</h4>

<p>Once the event has been shaped in the format that I want, it's time to send the payload to an EventBridge Bus. I'm going to shape the output into a result that I prefer.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="k">return</span> <span class="p">{</span>
    <span class="na">eventBridgeEventBusParameters</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">detailType</span><span class="p">:</span> <span class="dl">"</span><span class="s2">PatientChange</span><span class="dl">"</span><span class="p">,</span>
        <span class="na">source</span><span class="p">:</span> <span class="dl">"</span><span class="s2">com.binaryheap.patient</span><span class="dl">"</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="na">inputTemplate</span><span class="p">:</span> <span class="s2">`{
            "meta": {
                "correlationId": &lt;$.eventId&gt;,
                "changeType": &lt;$.eventType&gt;
            },
            "event": &lt;$.body&gt;
        }`</span><span class="p">,</span>
<span class="p">};</span>
</code></pre>

</div>



<p>Just like with the source input, I need to grant the consumer the ability to post to EventBridge.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="k">return</span> <span class="k">new</span> <span class="nx">PolicyDocument</span><span class="p">({</span>
    <span class="na">statements</span><span class="p">:</span> <span class="p">[</span>
        <span class="k">new</span> <span class="nx">PolicyStatement</span><span class="p">({</span>
            <span class="na">resources</span><span class="p">:</span> <span class="p">[</span><span class="nx">busArn</span><span class="p">],</span>
            <span class="na">actions</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="s2">events:PutEvents</span><span class="dl">"</span><span class="p">],</span>
            <span class="na">effect</span><span class="p">:</span> <span class="nx">Effect</span><span class="p">.</span><span class="nx">ALLOW</span><span class="p">,</span>
        <span class="p">}),</span>
    <span class="p">],</span>
<span class="p">});</span>
</code></pre>

</div>



<h3>
  
  
  Rules to Handle Item Types
</h3>

<p>Now that I've got a Pipe publishing to EventBridge's Default Bus, I can craft some rules. When Streaming DynamoDB to EventBridge Pipes in a MultiCast scenario, my specific rules will help target Lambda functions that I want to handle the Item changes. These could also be queues or anything else you like. This is where having multiple Item Types in one table comes back together. You could have service consumers handling all changes from the Patients table or you could have specific consumers dealing with the specific Item Types. My example shows the latter. I want to be specific to highlight the pattern.</p>

<h4>
  
  
  Patient Rule
</h4>

<p>When dealing with the Patient, I might want to address something specific about that record. I first need to build an EventBridge Rule for handling the Bus message and the target I want.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="k">this</span><span class="p">.</span><span class="nx">_handlerOne</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">GoFunction</span><span class="p">(</span><span class="nx">scope</span><span class="p">,</span> <span class="dl">"</span><span class="s2">ItemOneHandlerFunction</span><span class="dl">"</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">entry</span><span class="p">:</span> <span class="dl">"</span><span class="s2">src/type-one-handler</span><span class="dl">"</span><span class="p">,</span>
    <span class="na">functionName</span><span class="p">:</span> <span class="s2">`type-one-handler`</span><span class="p">,</span>
    <span class="na">timeout</span><span class="p">:</span> <span class="nx">Duration</span><span class="p">.</span><span class="nx">seconds</span><span class="p">(</span><span class="mi">15</span><span class="p">),</span>
    <span class="na">environment</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">IS_LOCAL</span><span class="p">:</span> <span class="dl">"</span><span class="s2">false</span><span class="dl">"</span><span class="p">,</span>
        <span class="na">LOG_LEVEL</span><span class="p">:</span> <span class="dl">"</span><span class="s2">DEBUG</span><span class="dl">"</span><span class="p">,</span>
        <span class="na">VERSION</span><span class="p">:</span> <span class="nx">props</span><span class="p">.</span><span class="nx">version</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">});</span>
</code></pre>

</div>



<p>This code will deploy the Lambda that will be the target for my Patient rule.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="kd">const</span> <span class="nx">rule</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Rule</span><span class="p">(</span><span class="nx">scope</span><span class="p">,</span> <span class="dl">"</span><span class="s2">ItemOnHandlerRule</span><span class="dl">"</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">eventPattern</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">detailType</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="s2">PatientChange</span><span class="dl">"</span><span class="p">],</span>
        <span class="na">detail</span><span class="p">:</span> <span class="p">{</span>
            <span class="na">meta</span><span class="p">:</span> <span class="p">{</span>
                <span class="na">changeType</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="s2">PatientModify</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">PatientInsert</span><span class="dl">"</span><span class="p">],</span>
            <span class="p">},</span>
        <span class="p">},</span>
    <span class="p">},</span>
    <span class="na">eventBus</span><span class="p">:</span> <span class="nx">EventBus</span><span class="p">.</span><span class="nx">fromEventBusArn</span><span class="p">(</span><span class="nx">scope</span><span class="p">,</span> <span class="dl">"</span><span class="s2">DefaultBusItemOne</span><span class="dl">"</span><span class="p">,</span> <span class="nx">busArn</span><span class="p">),</span>
    <span class="na">ruleName</span><span class="p">:</span> <span class="dl">"</span><span class="s2">item-one-rule</span><span class="dl">"</span><span class="p">,</span>
<span class="p">});</span>

<span class="kd">const</span> <span class="nx">dlq</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Queue</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="dl">"</span><span class="s2">ItemOneHandler-DLQ</span><span class="dl">"</span><span class="p">);</span>
<span class="nx">rule</span><span class="p">.</span><span class="nx">addTarget</span><span class="p">(</span>
    <span class="k">new</span> <span class="nx">targets</span><span class="p">.</span><span class="nx">LambdaFunction</span><span class="p">(</span><span class="nx">handler</span><span class="p">,</span> <span class="p">{</span>
        <span class="na">deadLetterQueue</span><span class="p">:</span> <span class="nx">dlq</span><span class="p">,</span>
    <span class="p">})</span>
<span class="p">);</span>
</code></pre>

</div>



<p>As you can notice, I'm looking for the top-level detail-type of <code>PatientChange</code>. Then I'm looking deeper into the payload for the <code>PatientInsert</code> and <code>PatientModify</code> change types. That then forwards into my Item One Lambda.</p>

<h4>
  
  
  Address Rule
</h4>

<p>Next, I build an almost identical rule, but specifically for Address.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="kd">const</span> <span class="nx">rule</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Rule</span><span class="p">(</span><span class="nx">scope</span><span class="p">,</span> <span class="dl">"</span><span class="s2">ItemTwoHandlerRule</span><span class="dl">"</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">eventPattern</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">detailType</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="s2">PatientChange</span><span class="dl">"</span><span class="p">],</span>
        <span class="na">detail</span><span class="p">:</span> <span class="p">{</span>
            <span class="na">meta</span><span class="p">:</span> <span class="p">{</span>
                <span class="na">changeType</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="s2">AddressModify</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">AddressInsert</span><span class="dl">"</span><span class="p">],</span>
            <span class="p">},</span>
        <span class="p">},</span>
    <span class="p">},</span>
    <span class="na">eventBus</span><span class="p">:</span> <span class="nx">EventBus</span><span class="p">.</span><span class="nx">fromEventBusArn</span><span class="p">(</span><span class="nx">scope</span><span class="p">,</span> <span class="dl">"</span><span class="s2">DefaultBusItemTwo</span><span class="dl">"</span><span class="p">,</span> <span class="nx">busArn</span><span class="p">),</span>
    <span class="na">ruleName</span><span class="p">:</span> <span class="dl">"</span><span class="s2">item-two-rule</span><span class="dl">"</span><span class="p">,</span>
<span class="p">});</span>

<span class="kd">const</span> <span class="nx">dlq</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Queue</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="dl">"</span><span class="s2">ItemTwoHandler-DLQ</span><span class="dl">"</span><span class="p">);</span>
<span class="nx">rule</span><span class="p">.</span><span class="nx">addTarget</span><span class="p">(</span>
    <span class="k">new</span> <span class="nx">targets</span><span class="p">.</span><span class="nx">LambdaFunction</span><span class="p">(</span><span class="nx">handler</span><span class="p">,</span> <span class="p">{</span>
        <span class="na">deadLetterQueue</span><span class="p">:</span> <span class="nx">dlq</span><span class="p">,</span>
    <span class="p">})</span>
<span class="p">);</span>
</code></pre>

</div>



<p><a href="https://res.cloudinary.com/practicaldev/image/fetch/s--sI2HST4c--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_800/https://www.binaryheap.com/wp-content/uploads/2023/09/address_change_pattern.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--sI2HST4c--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_800/https://www.binaryheap.com/wp-content/uploads/2023/09/address_change_pattern.png" alt="Address Rule" width="800" height="173"></a></p>

<p>On the backside of my targets, I have two separate Lambdas. They are identical for this example as they just print out the payload.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight go"><code><span class="k">func</span> <span class="n">handler</span><span class="p">(</span><span class="n">ctx</span> <span class="n">context</span><span class="o">.</span><span class="n">Context</span><span class="p">,</span> <span class="n">e</span> <span class="k">interface</span><span class="p">{})</span> <span class="p">(</span><span class="k">interface</span><span class="p">{},</span> <span class="kt">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">log</span><span class="o">.</span><span class="n">WithFields</span><span class="p">(</span><span class="n">log</span><span class="o">.</span><span class="n">Fields</span><span class="p">{</span>
        <span class="s">"body"</span><span class="o">:</span> <span class="n">e</span><span class="p">,</span>
    <span class="p">})</span><span class="o">.</span><span class="n">Debug</span><span class="p">(</span><span class="s">"Printing out the body"</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">e</span><span class="p">,</span> <span class="no">nil</span>
<span class="p">}</span>
</code></pre>

</div>



<p><strong>Patient Output</strong><br>
<a href="https://res.cloudinary.com/practicaldev/image/fetch/s--jbeoM6qn--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_800/https://www.binaryheap.com/wp-content/uploads/2023/09/patient_log.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--jbeoM6qn--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_800/https://www.binaryheap.com/wp-content/uploads/2023/09/patient_log.png" alt="Patient Output" width="800" height="395"></a></p>

<p><strong>Address Output</strong><br>
<a href="https://res.cloudinary.com/practicaldev/image/fetch/s--crzEGJDV--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_800/https://www.binaryheap.com/wp-content/uploads/2023/09/address_log.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--crzEGJDV--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_800/https://www.binaryheap.com/wp-content/uploads/2023/09/address_log.png" alt="Address Output" width="800" height="448"></a></p>

<h2>
  
  
  Notes on the Pattern
</h2>

<p>When streaming DynamoDB to EventBridge Pipes you have so many options from filtering, enriching and then ultimately the targets. I continue personally to put Pipes into my workloads as I find it performs super efficiently and is easy to set up and reason about. I also find that where I was using Step Functions for these types of workflows, I'm now defaulting to Pipes.</p>

<h2>
  
  
  Wrap Up
</h2>

<p>To pull things back together, Streaming DynamoDB has a limit of 2 consumers that you can attach to the stream. That limit isn't a big deal when you have 1 type of record in the table. You could have one stream handling Inserts and Modifies and then another Pipe to handle the Deletes. But when you have a Single-Table or Multi-Type situation, you need a few more services layered in.</p>

<p>Using EventBridge's Rules and Targets is exactly the service and capability that makes this possible. I also find that if you've got local teams with permission boundaries as well, this can be even further enhanced with an <a href="https://www.binaryheap.com/eventbus-mesh/">Event Bus Mesh</a>.</p>

<p>As always, for a [fully functioning <a href="https://github.com/benbpyle/ddb-stream-multi-cast">and working repository</a>, you can head on over to GitHub and clone it.</p>

<p>I hope this gets you a little more in your toolbox when working with DynamoDB Streams and EventBridge Pipes.</p>

<p>Happy Building!</p>

 </details> 
 <hr /> 
<!-- BLOG-POST-LIST:END -->
</table>
</details>


<!-- TODO
Change the 3stats boxes around, possibly two on top and one on bottom
Fix RSSfeed
Fix Spotify Playlists
Fix Socials [Portfolio, Discord, Linkedin]
In the future, add Public Repositories of Selected Projects
-->
