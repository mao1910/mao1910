<!-- VISITOR BADGE -->
<!-- https://github.com/hehuapei/visitor-badge -->

<img align="right" src="https://visitor-badge.laobi.icu/badge?page_id=mao1910.mao1910&left_color=%2379DAF9&right_color=%23FE6E96" />


<!-- TYPING SVG -->
<!-- https://github.com/DenverCoder1/readme-typing-svg -->

<h1 align="center">
    <img src="https://readme-typing-svg.herokuapp.com/?font=Righteous&size=35&center=true&vCenter=true&width=500&height=70&color=FE6E96&font=poppins&duration=5000&lines=Hi+There!+üëã;+I'm+Mao!;" />
</h1>

<br/>


<!-- ABOUT ME TERMINAL -->
<h1 align="center">
<img src="./assets/terminal-5.gif" alt="Terminal" />
</h1>

<br/><br/><br/>


<!-- TECHNOLOGIES LOGOS -->
<!-- https://github.com/tandpfun/skill-icons -->

<h2 align="center">üíª Languages / Frameworks / Tools ‚öíÔ∏è</h2>
<div align="center">
    <img src="https://skillicons.dev/icons?i=javascript,typescript,angular,react,html,css,scss,bootstrap,cs,java,spring" />
    <img src="https://skillicons.dev/icons?i=flutter,firebase,supabase,mysql,git,github,gitlab,vscode,idea,maven,figma" />
</div>

<br/><br/><br/>


<!-- CONTRIBUTIONS SNAKE GAME -->
<!-- https://github.com/Platane/snk -->

<div align="center">
  <h2> My Contributionssssüêç </h2>
  <br>
  <img alt="contributions-eating Snake" src="https://raw.githubusercontent.com/mao1910/mao1910/output/github-contribution-grid-snake.svg" />

  <!-- Four lines below suggested by Planate for Dark mode-->
  <picture>
  <source media="(prefers-color-scheme: dark)" srcset="github-snake-dark.svg" />
  <source media="(prefers-color-scheme: light)" srcset="github-snake.svg" />
  </picture>
  
  <br/><br/><br/>
</div>


<!-- GITHUB STATS -->
<!-- https://github.com/DenverCoder1/github-readme-streak-stats --> <!--  My Vercel -->
<!-- https://github.com/anuraghazra/github-readme-stats --> <!--  My own Vercel -->

<h2 align="center"> Statsüìù </h2>
  <br>
<div align=center>
  <img width=429 src="https://github-readme-stats-mao1910.vercel.app/api?username=mao1910&count_private=true&show_icons=true&theme=dracula&rank_icon=github&hide=contribs&border_radius=10&border_color=79DAF9" alt="github stats"/>
  <img width=396 src="https://github-readme-streak-stats-2235.vercel.app?user=mao1910&count_private=true&theme=dracula&currStreakNum=79DAF9&currStreakLabel=FE6E96&border_radius=10&border=79DAF9" alt="streak stats"/>
  <br/>
  <img src="https://github-readme-stats-mao1910.vercel.app/api/top-langs/?username=mao1910&layout=compact&theme=dracula&border_radius=10&size_weight=0.5&count_weight=0.5&border_color=79DAF9" alt="languages stats" />
</div>

<br/><br/><br/>


<!-- FOOTER -->
<!-- https://github.com/DenverCoder1/readme-typing-svg -->
<!-- https://readme-typing-svg.demolab.com/demo/ -->

<a href="https://git.io/typing-svg"><img src="https://readme-typing-svg.demolab.com?font=Poppins&pause=1000&color=FE6E96&width=535&lines=Thanks+for+dropping+by!;Feel+free+to+check+any+of+the+Socials+below+%F0%9F%91%87;Or+the+Joke+Of+The+Day+if+you're+down+for+a+giggle+%F0%9F%98%9D;Hope+to+see+you+again+%F0%9F%91%8A;Uh%3F+You're+still+here%3F;Well...+I'm+running+out+of+things+to+say...;Tell+you+what%2C+due+to+your+effort+and+perseverance%2C;I+shall+present+you+with+a+short+poem%3A;%22To+code%2C+or+not+to+code%2C+that+is+the+question%3A;Whether+'tis+nobler+in+the+IDE+to+debug;The+errors+and+issues+of+outrageous+software%2C;Or+to+take+up+the+keyboard+against+a+sea+of+bugs;And+by+coding%2C+end+them.%22;by+William+Shakespeare%2C+probably.+;Pretty+sure+that's+Hamlet's.;Alrighty%2C+this+has+been+fun.;But+I'll+restart+the+loop+now...+see+ya+soon!" alt="Typing SVG" /></a>


<!--  SOCIAL NETWORKS -->
<!-- https://github.com/alexandresanlim/Badges4-README.md-Profile -->

  <div> 
    <a href="https://www.deviantart.com/madeinkobaia/art/my-profile-is-under-construction-265626465" target="_blank"><img src="https://img.shields.io/badge/-LinkedIn-%230077B5?style=for-the-badge&logo=linkedin&logoColor=white" target="_blank"></a> <!-- ADD LINKEDIN PROFILE -->
    <a href = "https://www.nicepng.com/ourpic/u2q8o0t4t4r5o0r5_website-under-construction-png-graphic-transparent-website-under/"><img src="https://img.shields.io/badge/Portfolio-4285F4?style=for-the-badge&logo=Google-chrome&logoColor=white" target="_blank"></a> <!-- ADD PORTFOLIO WEBSITE -->
    <a href="https://discord.gg" target="_blank"><img src="https://img.shields.io/badge/Discord-7289DA?style=for-the-badge&logo=discord&logoColor=white" target="_blank"></a> <!-- ADD DISCORD --> <!-- User or Server? -->
    <a href = "mailto:mao1910dev@gmail.com"><img src="https://img.shields.io/badge/Gmail-D14836?style=for-the-badge&logo=gmail&logoColor=white" target="_blank"></a>
  </div>


<!-- SPOTIFY PLAYING-->
<!-- https://github.com/novatorem/novatorem --> <!-- My own Vercel deployment-->

[<img width=438px src="https://spotify-now-playing-git-main-mao1910.vercel.app//api/spotify/?border_color=FE6E96" alt="Mao Spotify Now Playing" />](https://open.spotify.com/user/31542et242zglhf42ydrtqgvuvde)


<!-- JOKE OF THE DAY -->
<!-- https://github.com/ABSphreak/readme-jokes --> <!-- My own Vercel deployment-->

<details>
<summary>I've got a Joke for you. Wanna hear it? üôà</summary>

<br/>

 <tr>
 <td style="padding-top:4px"><img src = "https://readme-jokes-git-master-mao1910.vercel.app/api?&theme=dracula"></td>
 </tr>

</details>


<!-- RSS FEED -->
<!-- https://github.com/gautamkrishnar/blog-post-workflow -->

<details>
<summary>üìï &nbsp;RSS feed</summary>

<br/>


<!-- BLOG-POST-LIST:START -->
 #### - [Is There a Developer Shortage?](https://dev.to/devteam/is-there-a-developer-shortage-2l56) 
 <details><summary>Article</summary> <p><em>Hey, hey, it's the Daily Byte! Over the next several days, we'll be talking about developer roles, success taits, and the future ahead. Today we tackle the burning question:</em>  </p>

<blockquote>
<p>Why is the software industry facing a developer shortage, and how can we address this issue?</p>
</blockquote>

<p>Share your insights into the ongoing debate about the scarcity of developers and follow the DEVteam for more discussions and online camaraderie!</p>


<div class="ltag__user ltag__user__id__1">
  <a href="/devteam" class="ltag__user__link profile-image-link">
    <div class="ltag__user__pic">
      <img src="https://res.cloudinary.com/practicaldev/image/fetch/s--DGMHY8k9--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_800/https://res.cloudinary.com/practicaldev/image/fetch/s--DG4H-3cI--/c_fill%2Cf_auto%2Cfl_progressive%2Ch_150%2Cq_auto%2Cw_150/https://dev-to-uploads.s3.amazonaws.com/uploads/organization/profile_image/1/d908a186-5651-4a5a-9f76-15200bc6801f.jpg" alt="devteam image">
    </div>
  </a>
  <div class="ltag__user__content">
    <h2>
      <a href="/devteam" class="ltag__user__link">The DEV Team</a>
      Follow
    </h2>
    <div class="ltag__user__summary">
      <a href="/devteam" class="ltag__user__link">
        The team behind this very platform. üòÑ
      </a>
    </div>
  </div>
</div>
 

 </details> 
 <hr /> 

 #### - [Hacktoberfest is coming](https://dev.to/jarvisscript/hacktoberfest-is-coming-58a4) 
 <details><summary>Article</summary> <p>Hacktoberfest is coming and this year DEV is teaming up with Hackotoberfest founder Digital Ocean to bring new badges to DEV.</p>

<p>Read <a href="https://dev.to/page/hacktoberfest-2023">DEV's HacktoberFest 2023 page.</a> to learn what is going on here.</p>

<p>Visit the <a href="https://hacktoberfest.com/">Official HacktoberFest</a> page this is where you go to sign up on September 26. Sign up here then prepare for the month.</p>

<p>Dev's Hacktoberfest preview blog.</p>


<div class="ltag__link">
  <a href="/devteam" class="ltag__link__link">
    <div class="ltag__link__org__pic">
      <img src="https://res.cloudinary.com/practicaldev/image/fetch/s--DGMHY8k9--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_800/https://res.cloudinary.com/practicaldev/image/fetch/s--DG4H-3cI--/c_fill%2Cf_auto%2Cfl_progressive%2Ch_150%2Cq_auto%2Cw_150/https://dev-to-uploads.s3.amazonaws.com/uploads/organization/profile_image/1/d908a186-5651-4a5a-9f76-15200bc6801f.jpg" alt="The DEV Team" width="150" height="150">
      <div class="ltag__link__user__pic">
        <img src="https://res.cloudinary.com/practicaldev/image/fetch/s--Q9agcq3k--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_800/https://res.cloudinary.com/practicaldev/image/fetch/s--vHKcEiTe--/c_fill%2Cf_auto%2Cfl_progressive%2Ch_150%2Cq_auto%2Cw_150/https://dev-to-uploads.s3.amazonaws.com/uploads/user/profile_image/3/13d3b32a-d381-4549-b95e-ec665768ce8f.png" alt="" width="150" height="150">
      </div>
    </div>
  </a>
  <a href="/devteam/hacktoberfest-2023-sneak-peek-at-badges-whats-to-come-4h22" class="ltag__link__link">
    <div class="ltag__link__content">
      <h2>Hacktoberfest 2023: Sneak Peek at Badges &amp; What's to Come</h2>
      <h3>dev.to staff for The DEV Team „Éª Sep 18</h3>
      <div class="ltag__link__taglist">
        <span class="ltag__link__tag">#hacktoberfest23</span>
      </div>
    </div>
  </a>
</div>


<p>I've participated in Hacktoberfest for three years, last year I even maintained a project. I've had four or more pull request accepted each of the the last three years.</p>

<p>I've got to collaborate on some cool projects. I've earned t-shirts, stickers, holopins, and DEV badges. Although I'm missing the 2021 one. </p>

<p>This year Digital Ocean is not giving out shirts or stickers. It's an expense thing, but you can earn digital pins and have a tree planted. Some companies offer incentives to earn their swag so look for them as you search for projects.  </p>

<p><a href="https://res.cloudinary.com/practicaldev/image/fetch/s--KUQGnU-c--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_800/https://dev-to-uploads.s3.amazonaws.com/i/ekhzparqr6g09yi9pctq.jpg" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--KUQGnU-c--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_800/https://dev-to-uploads.s3.amazonaws.com/i/ekhzparqr6g09yi9pctq.jpg" alt="completed progress bar. Show 4 filled in boxes " width="353" height="207"></a></p>

<p>Those PRs include code, documentation, transcribing podcasts,  and even writing some templates for a repo. It's been an enjoyable time and I'm ready to do it again.</p>

<p>2022<br>
</p>
<div class="ltag__link">
  <a href="/jarvisscript" class="ltag__link__link">
    <div class="ltag__link__pic">
      <img src="https://res.cloudinary.com/practicaldev/image/fetch/s--m6nqeORg--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_800/https://res.cloudinary.com/practicaldev/image/fetch/s--MuaiLKep--/c_fill%2Cf_auto%2Cfl_progressive%2Ch_150%2Cq_auto%2Cw_150/https://dev-to-uploads.s3.amazonaws.com/uploads/user/profile_image/8745/bd569b6a-807e-4368-9b91-c35dd617c562.jpeg" alt="jarvisscript">
    </div>
  </a>
  <a href="/jarvisscript/hacktoberfest-review-38e3" class="ltag__link__link">
    <div class="ltag__link__content">
      <h2>HacktoberFest Review</h2>
      <h3>Chris Jarvis „Éª Nov 3 '22</h3>
      <div class="ltag__link__taglist">
        <span class="ltag__link__tag">#documentation</span>
        <span class="ltag__link__tag">#hacktoberfest</span>
      </div>
    </div>
  </a>
</div>


<p>2021</p>


<div class="ltag__link">
  <a href="/jarvisscript" class="ltag__link__link">
    <div class="ltag__link__pic">
      <img src="https://res.cloudinary.com/practicaldev/image/fetch/s--m6nqeORg--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_800/https://res.cloudinary.com/practicaldev/image/fetch/s--MuaiLKep--/c_fill%2Cf_auto%2Cfl_progressive%2Ch_150%2Cq_auto%2Cw_150/https://dev-to-uploads.s3.amazonaws.com/uploads/user/profile_image/8745/bd569b6a-807e-4368-9b91-c35dd617c562.jpeg" alt="jarvisscript">
    </div>
  </a>
  <a href="/jarvisscript/hacktoberfest-review-18jh" class="ltag__link__link">
    <div class="ltag__link__content">
      <h2>HacktoberFest Review</h2>
      <h3>Chris Jarvis „Éª Nov 1 '21</h3>
      <div class="ltag__link__taglist">
        <span class="ltag__link__tag">#hacktoberfest</span>
      </div>
    </div>
  </a>
</div>


<p>2020</p>


<div class="ltag__link">
  <a href="/jarvisscript" class="ltag__link__link">
    <div class="ltag__link__pic">
      <img src="https://res.cloudinary.com/practicaldev/image/fetch/s--m6nqeORg--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_800/https://res.cloudinary.com/practicaldev/image/fetch/s--MuaiLKep--/c_fill%2Cf_auto%2Cfl_progressive%2Ch_150%2Cq_auto%2Cw_150/https://dev-to-uploads.s3.amazonaws.com/uploads/user/profile_image/8745/bd569b6a-807e-4368-9b91-c35dd617c562.jpeg" alt="jarvisscript">
    </div>
  </a>
  <a href="/jarvisscript/hacktoberfest-4-of-4-1aoo" class="ltag__link__link">
    <div class="ltag__link__content">
      <h2>Hacktoberfest 4 of 4</h2>
      <h3>Chris Jarvis „Éª Oct 8 '20</h3>
      <div class="ltag__link__taglist">
        <span class="ltag__link__tag">#hacktoberfest</span>
        <span class="ltag__link__tag">#11ty</span>
      </div>
    </div>
  </a>
</div>


<p><a href="https://res.cloudinary.com/practicaldev/image/fetch/s--WtGRHyFq--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_800/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/94wnb20mnv8a4ur85brq.jpg" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--WtGRHyFq--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_800/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/94wnb20mnv8a4ur85brq.jpg" alt="DEV hacktoberFest22 Badge. Wireframe sphere with a capital H" width="690" height="343"></a></p>

<p>This is my pledge to participate in HacktoberFest 2023. Are you joining the fun this year?<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight html"><code>-$JarvisScript git push
</code></pre>

</div>



 </details> 
 <hr /> 

 #### - [OpenMP Notes](https://dev.to/winstonpuckett/openmp-notes-1cfa) 
 <details><summary>Article</summary> <h2>
  
  
  What is this document?
</h2>

<p>I recently went through Tim Mattson's <a href="https://youtube.com/playlist?list=PLLX-Q6B8xqZ8n8bwjGdzBJ25X2utwnoEG&amp;si=VlCiP_gIHKOfBHQC">Introduction to OpenMP</a>, a  27-video course which outlines all of the major constructs and underlying principles in OpenMP. It's a wonderful course with lots of helpful information and I recommend you take it yourself. Here are my condensed notes on the course.</p>

<h2>
  
  
  Why OpenMP?
</h2>

<p>Parallelism is important because of power usage - Moore's law continues to hold, but the power to runs chip with twice as many capacitors grows almost quadratically with the number of capacitors used.</p>

<p>Instead, by running just two cores in parallel, we find a 40% reduction in the power used for a given input of work.</p>

<p><a href="https://youtu.be/cMWGeJyrc9w?si=XYPQzEBkBwGHgg7_">https://youtu.be/cMWGeJyrc9w?si=XYPQzEBkBwGHgg7_</a></p>

<p>Concurrency is async (could be happening at the same time). Parallel is when you map so that it <strong>is</strong> done at the same time.</p>

<p>OpenMP assumes shared address space hardware.</p>

<p>Example of pragmas OpenMP uses:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight c"><code><span class="cp">#pragma omp construct clauses
</span>
<span class="c1">// simplest</span>
<span class="cp">#pragma omp parallel
</span>
<span class="c1">// You can combine statements like</span>
<span class="cp">#pragma omp parallel for
</span><span class="k">for</span> <span class="p">...</span>

<span class="c1">// Instead of</span>
<span class="cp">#pragma omp parallel
</span><span class="p">{</span>
    <span class="cp">#pragma omp for
</span>    <span class="k">for</span> <span class="p">...</span>
<span class="p">}</span>
</code></pre>

</div>



<p>Blocks must not exit in the middle.</p>

<h2>
  
  
  Shared memory machines
</h2>

<h3>
  
  
  SMP Symmetric MultiProcessor
</h3>

<p>Operating system treats each thread the same with same amount of time devoted to each thread.</p>

<p>No special blocks of memory - all memory <em>should</em> be equally performant and accessible </p>

<h3>
  
  
  NUMA Non-Uniform Memory Architecture
</h3>

<p>Understands and takes advantage of the fact that access time to certain memory is faster if it's physically closer to the processor .</p>

<p>Nothing is truly an SMP these days, but we pretend it is... at least for CPUs. I'm curious about SMPs vs NUMAs in the world of GPUs.</p>

<h2>
  
  
  Random good info
</h2>

<ul>
<li>Race conditions and synchronization are the most common errors in parallel programming.</li>
<li>Fundamental model behind OpenMP is the Fork-Join model</li>
<li>A collection of threads is called a Team.</li>
<li>
<code>#pragma omp parallel</code> is what forks</li>
<li>
<code>omp_set_num_threads(4)</code> tells OMP how many threads to use if it's unspecified in the pragma.</li>
<li>Data allocated outside the parallel block will go on the heap and be visible to all threads. Data allocated inside the block will be allocated to the stack and be visible only to the thread. They use "private" canonically. </li>
<li>A generated function is called a thunk.</li>
<li>
<p>Question, OpenMP uses <code>pthreads</code> under the hood when it compiles down.  Would an NVIDIA GPU also do that or does it compile to a CUDA-specific implementation?</p>
<h2>
  
  
  SPMD - Single Program, Multiple Data
</h2>
</li>
<li><p>Each thread runs identical code against different data</p></li>
<li><p>Cyclic distribution of loop iterations: increment the loop number by the number of threads .</p></li>
<li><p>To eliminate race conditions, we can promote a scalar like <code>sum</code> to an array.</p></li>
<li>
<p>Because we may get a different number of threads than we request, you may need to have any thread (id 0 most likely) check the thread count we got.</p>
<h2>
  
  
  False sharing:
</h2>
</li>
<li><p>If independent data happens to sit on the same cache line, each update will cause cache lines to "slosh back and forth" between threads.</p></li>
<li><p>Promoting a scalar to an array and using a round-robin strategy is one example where we create false sharing and poor scalability.</p></li>
<li><p>One way to avoid false sharing is by padding the array so that separate threads will be guaranteed to show up in separate cache lines. To do this, make the sum array multidimensional and use the first value <code>[i][0]</code> for the actual value</p></li>
<li>
<p>Synchronization solves false sharing without us having to know the underlying cache sizes.</p>
<h2>
  
  
  Synchronization
</h2>
</li>
<li><p>Barrier Synchronization is "each thread should wait until all threads arrive"</p></li>
<li><p>Mutual exclusion: "only one thread can access x resource"</p></li>
</ul>

<p>Constructs:<br>
Note that pragmas are always applicable to the thing directly below. So use blocks if you want to effect multiple things.</p>
<h3>
  
  
  Critical
</h3>

<p>Only one resource may access at a time:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight c"><code><span class="kt">int</span> <span class="n">sum</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="cp">#pragma omp parallel
</span><span class="p">{</span>
    <span class="kt">int</span> <span class="n">id</span> <span class="o">=</span> <span class="n">omp_get_thread_num</span><span class="p">();</span>
<span class="cp">#pragma omp critical
</span>    <span class="n">sum</span> <span class="o">+=</span> <span class="n">id</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>

</div>



<h3>
  
  
  Atomic
</h3>



<div class="highlight js-code-highlight">
<pre class="highlight plaintext"><code>#pragma omp atomic

#pragma omp atomic read|write|update|capture
</code></pre>

</div>



<p>"If the low-level, high performance constructs for mutual exclusion exist on this hardware, use them. Otherwise act like this is a critical section."</p>

<p>Is there any benefit to critical sections in this case? Perhaps critical sections allow for function calls, where atomic only refers to a scalar set operation? Yes - video just said this is just available for simple binary operations to update values. </p>

<h3>
  
  
  Barrier
</h3>

<p>Wait until all threads process to this point before moving on:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight c"><code><span class="cp">#pragma omp parallel
</span><span class="p">{</span>
    <span class="kt">int</span> <span class="n">id</span> <span class="o">=</span> <span class="n">omp_get_thread_num</span><span class="p">();</span>
<span class="cp">#pragma omp barrier
</span>    <span class="n">printf</span><span class="p">(</span><span class="s">"%d"</span><span class="p">,</span> <span class="n">id</span><span class="p">);</span>
<span class="p">}</span>

</code></pre>

</div>



<h3>
  
  
  Flush
</h3>

<p>Compilers are really good at optimizing where reads and writes occur. The order that you place operations in may not be the same order things happen if they are deemed to have equivalent results. This holds true for OpenMP. If you need to make reads and writes consistent, you need to use a Flush.</p>

<p>Creates a synchronization point that says, "you are guaranteed to have a consistent view of memory with the flush set." The flush set is the list of variables inside parenthesis passed to the flush pragma. When you leave off the flush set, everything must be consistent.</p>

<blockquote>
<p>All reads and writes before the flush must resolve to memory before and reads or writes to memory after the flush set.</p>
</blockquote>

<p>Flushes with overlapping flush sets may not be reordered with respect to each other.</p>

<p>For all intents and purposes, flush is equivalent to a fence in compiler terminology.</p>

<p>Flushes are hard to get right, so OpenMP provides implicit flushes at:</p>

<ul>
<li>entering/exiting parallel regions</li>
<li>implicit/explicit barriers</li>
<li>entry/exit to critical sections</li>
<li>set/unset of a lock</li>
</ul>

<p>Flush makes variables available to other threads. </p>

<p>If you spin lock on a variable, you also need to put a flush in the body of the loop. That forces the compiler to read the value every time not from a cache.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight c"><code><span class="cp">#pragma omp flush
</span>
<span class="cp">#pragma omp flush(variableOne, variableTwo)
</span></code></pre>

</div>



<h3>
  
  
  Master
</h3>

<p><code>#pragma omp master</code> schedules the next block on the main thread. For most use cases of master, you usually want a barrier on the next statement.</p>

<h2>
  
  
  Work sharing
</h2>

<p>Note: there is an implicit barrier at the end of any work sharing construct. <code>nowait</code> skips the barrier. There's no way to turn off the barrier at the end of a parallel region.</p>

<p>Constructs</p>

<ul>
<li>Loop

<ul>
<li>
<code>#pragma omp for</code> </li>
<li>
<code>#pragma omp for schedule</code>

<ul>
<li>tells compiler how to split up loops between threads</li>
<li>
<code>... schedule(static, optional chunk size)</code>: figure out how to break these loops into blocks at compile time </li>
<li>
<code>... schedule(dynamic, optional chunk size)</code>: create a task queue and pull from it until there's no more work. This is better when you have radically different work from one thread to the next. If you leave off chunk size, it will do one at a time.</li>
<li>
<code>... schedule(guided, optional chunk size)</code>: start with a large chunk size and get smaller as you go along. This was popular after a paper said this was optimal, but these days we know that the other two are usually better.</li>
<li>
<code>... schedule(runtime)</code>: take the schedule and chunk size from the OMP_SCHEDULE environment variable or runtime library. This is useful when you aren't sure what schedule you want to use, so you compile the program once and try a bunch of them out. <code>omp_set_schedule()</code> is how you set the schedule.</li>
<li>
<code>... schedule(auto)</code>: a new schedule which leaves the decision up to the compiler. How is this different from leaving off the schedule parameter? I'm guessing leaving it off means that you accept a default vs do compiler magic.</li>
</ul>


</li>
</ul>
</li>
<li>Reduction

<ul>
<li>
<code>#pragma omp parallel reduction (operator: variables)</code> | <code>#pragma omp parallel for reduction(operator: variables)</code>
</li>
<li>common task: Find the compute intensive loops, make it so that you can run them independently, insert omp for</li>
<li>"Loop carry dependencies" Are variables which are dependent on the loops</li>
<li>accumulating across a data structure is called a reduction.</li>
<li>when we use the reduction operator, omp creates a local copy of the list of variables and initializes them to the identity of the operator (+=0, *=1)</li>
<li>when the parallelizations are done, reduction construct combines everything into a single variable for you. Then combines that with the global copy to give you a final answer.</li>
<li>One interesting thing is that you can do reductions over binary operations like &amp;. Question, does that short circuit?</li>
</ul>


</li>
<li>Section/Sections

<ul>
<li>schedule different portions of a sequence on different threads</li>
<li>
<code>sections</code> for the outer block, <code>section</code> for each inner statement</li>
</ul>


</li>
<li>Single

<ul>
<li>"only the first three to hit this will execute it."</li>
<li>note that there's still an implicit barrier because this is a work sharing construct.</li>
<li><code>... omp single</code></li>
</ul>


</li>
<li>Task

<ul>
<li>Consists of data environment, code to execute, "Internal Control Variables" or ICV.

<ul>
<li>In OpenMP there are certain features of the environment that constructs control (like number of threads). These are ICVs.</li>
</ul>


</li>
<li>
<code>#pragma omp task</code> , <code>#pragma omp taskwait</code>
</li>
<li>It looks like taskwait is what creates the implicit barrier in this case. The current thread will keep executing after it has spawned a task with the task construct.</li>
<li>when you use recursion, look at whether you need to set anything as shared, firstprivate etc. It's so common in tasks that we default private to firstprivate.</li>
</ul>
</li>
<li>Lock

<ul>
<li>
<code>omp_init_lock()</code> , <code>omp_set_lock()</code> for acquire, <code>omp_unset_lock()</code> for release. <code>omp_destroy_lock()</code> to release the lock's memory. <code>omp_test_lock()</code> to find out if the lock is available, but not wait for it to be available.</li>
<li>Useful when you have lots of bins where you have a low chance of trying to update two things at the same time.</li>
</ul>


</li>
</ul>

<h2>
  
  
  Runtime Library Routines
</h2>

<ul>
<li>
<code>omp_get_num_threads()</code> get the current number of threads omp works with.

<ul>
<li>outside a parallel region, this returns 1.</li>
</ul>


</li>
<li>
<code>omp_set_num_threads()</code> set the current number of threads omp works with.</li>
<li>
<code>omp_get_thread_num()</code> get the current thread id.</li>
<li>
<code>omp_get_max_threads()</code> get the max number of threads we could use for this system.</li>
<li>
<code>omp_in_parallel()</code> is this running in parallel?</li>
<li>
<code>omp_set_dynamic()</code>  set dynamic mode (whether omp gets smart about how many threads you get for a given parallel region)</li>
<li>
<code>omp_get_dynamic()</code> is this running in dynamic mode?</li>
<li>

<p><code>omp_num_procs()</code> how many processors are there on this system?</p>

<h2>
  
  
  Environment Variables
</h2>


</li>
<li><p><code>OMP_NUM_THREADS</code> the number of threads we request, given this is an integer literal. In a production system, we almost always want to do this rather than have the code be responsible.</p></li>
<li><p><code>OMP_STACKSIZE</code> ask for extra stack size in cases where you allocate large variables to the stack. This prevents stack overflow.</p></li>
<li><p><code>OMP_WAIT_POLICY ACTIVE | PASSIVE</code> if ACTIVE, spin the thread until you get the lock (spin lock). If PASSIVE, suspend the thread until there's available resources. Waking suspended threads costs a lot, so use PASSIVE when you expect to have long wait times and don't want the thread eating resources.</p></li>
<li>

<p><code>OMP_PROC_BIND TRUE | FALSE</code> if enabled, once you bind a thread to a processor, leave it there. This helps as no processor actually has uniform memory access, so we can optimize for the regions of memory closer to the processor. The disadvantage is that if something else eats up that processor (antivirus scan for example), you don't remap onto a processor which is available.</p>

<h2>
  
  
  Data Environment
</h2>


</li>
</ul>

<p>Heap is shared, stack is local to a thread.</p>

<p>Variables can be shared, private, or firstprivate/lastprivate. First and last means "the xth time you set this, it will remain that."</p>

<p><code>... for private(tmp)</code> is an example of a declaration.</p>

<ul>
<li><code>firstprivate(variable)</code></li>
<li><code>lastprivate(variable)</code></li>
</ul>

<p>You can declare something as both first and last private. I have questions about what that would do.</p>

<h3>
  
  
  Thread private
</h3>

<p>What if we want a global variable that's private to each thread?<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight c"><code><span class="kt">int</span> <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="cp">#pragma omp threadprivate(counter)
</span>
<span class="kt">void</span> <span class="nf">incrementCounter</span><span class="p">()</span>
<span class="p">{</span>
    <span class="cp">#pragma omp parallel for copyin(counter)
</span>    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="n">_000</span><span class="p">,</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> 
    <span class="p">{</span>
        <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>

</div>



<p>This isn't a real use case btw, I just wanted an example. For this, we should be using atomic.</p>

<h2>
  
  
  Debugging
</h2>

<p>You need to use a parallel debugger. Visual Studio has one.</p>

<p>Default <code>none</code> for your data environment can help you debug, because it forces you to declare the type of everything. </p>

<p>Remember, the compiler skips pragmas it doesn't recognize are skipped.</p>

<h2>
  
  
  Memory Model of OpenMP
</h2>

<p>There is shared memory and each thread gets a cache. How do you guarantee whether you're getting the most up to date value?</p>

<p>The order you put loads and stores may be quite different than what gets executed.</p>

<p>The memory model gives you precise controls over reads (r), writes (w), and synchronization (s) operations.</p>

<p>Sequential consistency is when r's, w's, s's are in the order you put them in. All threads will see them in this order, and execute as such. This creates a lot of constraints on optimizations.</p>

<p>Relaxed consistency means that you can move, as long as you don't change the output. For instance, you can't change ordering around synchronization operations. You as the programmer have to use these synchronization operations to order what needs to be consistent.</p>

<p>For more on this, see the Flush construct above.</p>

<h2>
  
  
  Other Resources
</h2>

<ul>
<li><a href="https://youtu.be/4Hlc2KoRcFI?si=I9GJ-giVbfZLvJxq">Practical Approach to OpenMP for NVIDIA GPUs by Guray Ozen</a></li>
<li>Good quote from this course: "Computing is free, all you do is pay for data movement and the computing costs you nothing."</li>
<li>The recapitulation video in this series focussed on the design patterns from the course. It was really good: <a href="https://youtu.be/sNmGXNBzofM?si=qzR1cNPh1C02qLM1">https://youtu.be/sNmGXNBzofM?si=qzR1cNPh1C02qLM1</a>
</li>
</ul>

 </details> 
 <hr /> 

 #### - [Enhancing Redwood: A Guide to Implementing Zod for Data Validation and Schema Sharing Between the API and Web Layers](https://dev.to/growms/enhancing-redwood-a-guide-to-implementing-zod-for-data-validation-and-schema-sharing-between-the-api-and-web-layers-4do0) 
 <details><summary>Article</summary> <p>First things first: This walkthrough has been conducted on macOS. It uses symlinks, so I can't provide information about the setup on Windows.</p>

<h2>
  
  
  The Story
</h2>

<p>I'm currently experimenting with the fantastic <a href="https://redwoodjs.com/">Redwood</a> framework. However, while going through the excellent <a href="https://redwoodjs.com/docs/tutorial/foreword">tutorial</a>, I didn't find any guidance on using data validation libraries like <a href="https://github.com/jquense/yup/tree/pre-v1">Yup</a>, <a href="https://zod.dev/">Zod</a>, <a href="https://vestjs.dev/">Vest</a>, etc. So, I had to do some investigation and came up with a solution. This article describes the implementation of validation with Zod in a fresh Redwood app. You can find the sources at this <a href="https://github.com/growms/redwood-zod">github repository</a>.</p>

<p><strong>Note</strong>: I'm not a React, Yarn or even WebPack expert. I used to be an Angular developer, and I work with <a href="https://nx.dev/">Nx</a> for workspace management.</p>

<h2>
  
  
  Setup
</h2>

<p>Let's begin with a brand new Redwood app:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight shell"><code><span class="c"># Create the app</span>
yarn create redwood-app my-redwood-zod
<span class="nb">cd </span>my-redwood-zod
<span class="c"># Migrate the default schema "UserExample"</span>
yarn rw prisma migrate dev
<span class="c"># Generate the CRUD for "UserExample"</span>
yarn rw g scaffold UserExample
<span class="c"># Launch the development server</span>
yarn redwood dev
</code></pre>

</div>



<h2>
  
  
  Sharing Code
</h2>

<p>Start by creating the basic structure and sharing a variable called "userExampleSchema," which contains a string (although its content may change in the near future):<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight shell"><code><span class="c"># Create the folder to be shared</span>
<span class="nb">mkdir</span> <span class="nt">-p</span> ./api/src/lib/common
<span class="c"># Create a zod.ts file with a basic variable</span>
<span class="nb">echo</span> <span class="s2">"export const userExampleSchema: string = </span><span class="se">\"</span><span class="s2">I'm a shared value written in TypeScript!</span><span class="se">\"</span><span class="s2">"</span> <span class="o">&gt;</span> ./api/src/lib/common/zod.ts
<span class="c"># Add the symlink to be able to use the common libs on the "web" side</span>
<span class="nb">ln</span> <span class="nt">-s</span> ../../../api/src/lib/common ./web/src/lib/common
</code></pre>

</div>



<p>Why symlink ? I have experimented with babel.config.js, tsconfig, webpack.config.js and just could make it work properly, there was always drawbacks deploying or testing whatsoever. Once again i'm not a pro with yarn and webpack so if you have a better way feel free to share in comment !</p>

<p>We should ignore the symlink in <code>.gitignore</code> to avoid any code duplication:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="c1">// .gitignore</span>
<span class="p">...</span>
<span class="nx">web</span><span class="o">/</span><span class="nx">src</span><span class="o">/</span><span class="nx">lib</span><span class="o">/</span><span class="nx">common</span>
</code></pre>

</div>



<p>That's it! Now let's see if it works. Edit <code>UserExampleForm.tsx</code>:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="c1">// web/src/components/UserExample/UserExampleForm/UserExampleForm.tsx</span>

<span class="k">import</span> <span class="p">{</span> <span class="nx">userExampleSchema</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">src/lib/common/zod</span><span class="dl">'</span><span class="p">;</span>
<span class="p">...</span>
<span class="kd">const</span> <span class="nx">UserExampleForm</span> <span class="o">=</span> <span class="p">(</span><span class="nx">props</span><span class="p">:</span> <span class="nx">UserExampleFormProps</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="p">...</span>
  <span class="k">return</span> <span class="p">(</span>
    <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="dl">"</span><span class="s2">rw-form-wrapper</span><span class="dl">"</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="nx">Shared</span> <span class="na">Variable</span><span class="p">:</span> <span class="p">{</span><span class="nx">userExampleSchema</span><span class="p">}</span><span class="o">&lt;</span><span class="sr">/h1</span><span class="err">&gt;
</span>      <span class="p">...</span>
    <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>  <span class="p">);</span>
<span class="p">};</span>
<span class="k">export</span> <span class="k">default</span> <span class="nx">UserExampleForm</span><span class="p">;</span>
</code></pre>

</div>



<p>Check at <a href="http://localhost:8910/user-examples/new">http://localhost:8910/user-examples/new</a>!</p>

<p><a href="https://res.cloudinary.com/practicaldev/image/fetch/s--rv7HTTu5--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_800/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/vb17ylo2nrycsp2jvqnl.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--rv7HTTu5--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_800/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/vb17ylo2nrycsp2jvqnl.png" alt="Image description" width="800" height="188"></a></p>

<p>One side done ! what about the server ? let‚Äôs edit <code>api/src/ervices/userExamples.ts</code> :<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">userExampleSchema</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">src/lib/common/zod</span><span class="dl">'</span>
<span class="p">...</span>

<span class="k">export</span> <span class="kd">const</span> <span class="nx">userExamples</span><span class="p">:</span> <span class="nx">QueryResolvers</span><span class="p">[</span><span class="dl">'</span><span class="s1">userExamples</span><span class="dl">'</span><span class="p">]</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">aSharedVar</span><span class="dl">'</span><span class="p">,</span> <span class="nx">userExampleSchema</span><span class="p">)</span> <span class="c1">// +</span>
  <span class="k">return</span> <span class="nx">db</span><span class="p">.</span><span class="nx">userExample</span><span class="p">.</span><span class="nx">findMany</span><span class="p">()</span>
<span class="p">}</span>
<span class="p">...</span>
</code></pre>

</div>



<p>Then go at <a href="http://localhost:8910/user-examples">http://localhost:8910/user-examples</a> and look at logs you should see our string ! :</p>

<p><a href="https://res.cloudinary.com/practicaldev/image/fetch/s--p9zk5OLj--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_800/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/6y57a73y0h5xxgxx69yr.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--p9zk5OLj--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_800/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/6y57a73y0h5xxgxx69yr.png" alt="Image description" width="800" height="104"></a></p>

<p>It seems to work ! but as we are ‚Äúclean coders‚Äù we need to check that test is working too so let‚Äôs make a small one. Add a <code>zod.test.ts</code> file in the <code>common</code> directory to test our variable :<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">userExampleSchema</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./zod</span><span class="dl">'</span>

<span class="nx">describe</span><span class="p">.</span><span class="nx">only</span><span class="p">(</span><span class="dl">'</span><span class="s1">zod</span><span class="dl">'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">it</span><span class="p">(</span><span class="dl">'</span><span class="s1">has userExampleSchema const</span><span class="dl">'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">expect</span><span class="p">(</span><span class="nx">userExampleSchema</span><span class="p">).</span><span class="nx">not</span><span class="p">.</span><span class="nx">toBeUndefined</span><span class="p">()</span>
  <span class="p">})</span>
<span class="p">})</span>
</code></pre>

</div>



<p>You can run test on Redwoodwith the command  <code>yarn rw test</code> then type <code>t</code> and <code>zod</code></p>

<p>Sharing is done, let‚Äôs adding Zod validation.</p>

<h2>
  
  
  Zod validation
</h2>

<h3>
  
  
  Server Side
</h3>

<p>Now let's work on the server side. First, install <code>zod</code> in the <code>api</code> workspace:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight shell"><code><span class="nb">cd </span>api <span class="o">&amp;&amp;</span> yarn add zod <span class="o">&amp;&amp;</span> <span class="nb">cd</span> ..
</code></pre>

</div>



<p>Remove the reference to <code>userExampleSchema</code> in <code>UserExampleForm.tsx</code> to avoid unnecessary errors. Replace the old string with an actual Zod schema to validate our email and name:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="c1">// api/src/lib/common/zod.ts</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">z</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">zod</span><span class="dl">'</span><span class="p">;</span>

<span class="k">export</span> <span class="kd">const</span> <span class="nx">userExampleSchema</span> <span class="o">=</span> <span class="nx">z</span><span class="p">.</span><span class="nx">object</span><span class="p">({</span>
  <span class="na">email</span><span class="p">:</span> <span class="nx">z</span><span class="p">.</span><span class="kr">string</span><span class="p">().</span><span class="nx">min</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">{</span> <span class="na">message</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Email is required</span><span class="dl">'</span> <span class="p">}).</span><span class="nx">email</span><span class="p">({</span>
    <span class="na">message</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Must be a valid email</span><span class="dl">'</span><span class="p">,</span>
  <span class="p">}),</span>
  <span class="na">name</span><span class="p">:</span> <span class="nx">z</span><span class="p">.</span><span class="kr">string</span><span class="p">(),</span>
<span class="p">});</span>
</code></pre>

</div>



<p>To validate the data in a "Redwood way," we need to return a <code>RedwoodError</code>. If we want to have a nice field mapping, it should comply with the <a href="https://github.com/redwoodjs/redwood/blob/main/packages/api/src/validations/errors.ts#L6">ServiceValidationError</a>. Let's add our custom error and a <code>validateWithZod()</code> utility to use it in our services:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="c1">// api/src/lib/zodValidation.ts</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">ZodError</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">zod</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">RedwoodError</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@redwoodjs/api</span><span class="dl">'</span><span class="p">;</span>

<span class="k">export</span> <span class="kd">class</span> <span class="nx">ZodValidationError</span> <span class="kd">extends</span> <span class="nx">RedwoodError</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">(</span><span class="nx">error</span><span class="p">:</span> <span class="nx">ZodError</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="p">{</span> <span class="nx">issues</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">error</span><span class="p">;</span>
    <span class="kd">const</span> <span class="nx">errorMessage</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">Validation failed</span><span class="dl">'</span><span class="p">;</span>

    <span class="kd">const</span> <span class="nx">messages</span> <span class="o">=</span> <span class="p">{};</span>

    <span class="kd">const</span> <span class="nx">extensions</span> <span class="o">=</span> <span class="p">{</span>
      <span class="na">code</span><span class="p">:</span> <span class="dl">'</span><span class="s1">BAD_USER_INPUT</span><span class="dl">'</span><span class="p">,</span>
      <span class="na">properties</span><span class="p">:</span> <span class="p">{</span>
        <span class="nx">messages</span><span class="p">,</span>
      <span class="p">},</span>
    <span class="p">};</span>

    <span class="c1">// Process each error and add it to messages object</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">const</span> <span class="p">{</span> <span class="nx">message</span><span class="p">,</span> <span class="nx">path</span> <span class="p">}</span> <span class="k">of</span> <span class="nx">issues</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">path</span><span class="p">.</span><span class="nx">forEach</span><span class="p">((</span><span class="nx">pathItem</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">messages</span><span class="p">[</span><span class="nx">pathItem</span><span class="p">]</span> <span class="o">=</span> <span class="nx">messages</span><span class="p">[</span><span class="nx">pathItem</span><span class="p">]</span> <span class="o">||</span> <span class="p">[];</span>
        <span class="nx">messages</span><span class="p">[</span><span class="nx">pathItem</span><span class="p">].</span><span class="nx">push</span><span class="p">(</span><span class="nx">message</span><span class="p">);</span>
      <span class="p">});</span>
    <span class="p">}</span>

    <span class="k">super</span><span class="p">(</span><span class="nx">errorMessage</span><span class="p">,</span> <span class="nx">extensions</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">ZodValidationError</span><span class="dl">'</span><span class="p">;</span>

    <span class="nb">Object</span><span class="p">.</span><span class="nx">setPrototypeOf</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">ZodValidationError</span><span class="p">.</span><span class="nx">prototype</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="k">export</span> <span class="kd">const</span> <span class="nx">validateWithZod</span> <span class="o">=</span> <span class="p">(</span><span class="nx">input</span><span class="p">:</span> <span class="kr">any</span><span class="p">,</span> <span class="nx">schema</span><span class="p">:</span> <span class="kr">any</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">schema</span><span class="p">.</span><span class="nx">safeParse</span><span class="p">(</span><span class="nx">input</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">result</span><span class="p">.</span><span class="nx">success</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">throw</span> <span class="k">new</span> <span class="nx">ZodValidationError</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">error</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">};</span>
</code></pre>

</div>



<p>All the hard work is done. Enjoy:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="c1">// api/src/services/userExamples.ts</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">userExampleSchema</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">src/lib/common/zod</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">validateWithZod</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">src/lib

/zodValidation</span><span class="dl">'</span><span class="p">;</span>
<span class="p">...</span>
<span class="k">export</span> <span class="kd">const</span> <span class="nx">createUserExample</span><span class="p">:</span> <span class="nx">MutationResolvers</span><span class="p">[</span><span class="dl">'</span><span class="s1">createUserExample</span><span class="dl">'</span><span class="p">]</span> <span class="o">=</span> <span class="p">({</span>
  <span class="nx">input</span><span class="p">,</span>
<span class="p">})</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">validateWithZod</span><span class="p">(</span><span class="nx">input</span><span class="p">,</span> <span class="nx">userExampleSchema</span><span class="p">);</span>

  <span class="k">return</span> <span class="nx">db</span><span class="p">.</span><span class="nx">userExample</span><span class="p">.</span><span class="nx">create</span><span class="p">({</span>
    <span class="na">data</span><span class="p">:</span> <span class="nx">input</span><span class="p">,</span>
  <span class="p">});</span>
<span class="p">};</span>
</code></pre>

</div>



<p>Yep, it's just one method call!</p>

<p><a href="https://res.cloudinary.com/practicaldev/image/fetch/s---3dPid9t--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_800/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/ygtbz7iykb3cfupdwg0z.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s---3dPid9t--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_800/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/ygtbz7iykb3cfupdwg0z.png" alt="Image description" width="800" height="557"></a></p>

<p><strong>Note</strong>: Don't forget to update the related tests in <code>userExamples.test.ts</code> to ensure they pass.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="c1">// api/src/services/userExamples.test.ts</span>
<span class="p">...</span>
<span class="nx">scenario</span><span class="p">(</span>
    <span class="dl">'</span><span class="s1">creates a userExample with valid email and non-empty name</span><span class="dl">'</span><span class="p">,</span>
    <span class="k">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="c1">// Test that email must be valid</span>
      <span class="k">await</span> <span class="nx">expect</span><span class="p">(</span><span class="k">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">await</span> <span class="nx">createUserExample</span><span class="p">({</span>
          <span class="na">input</span><span class="p">:</span> <span class="p">{</span> <span class="na">email</span><span class="p">:</span> <span class="dl">'</span><span class="s1">String1484848</span><span class="dl">'</span><span class="p">,</span> <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">John</span><span class="dl">'</span> <span class="p">},</span>
        <span class="p">});</span>
      <span class="p">}).</span><span class="nx">rejects</span><span class="p">.</span><span class="nx">toThrow</span><span class="p">(</span><span class="nx">ZodValidationError</span><span class="p">);</span>

      <span class="c1">// Test that email must not be empty</span>
      <span class="k">await</span> <span class="nx">expect</span><span class="p">(</span><span class="k">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">await</span> <span class="nx">createUserExample</span><span class="p">({</span>
          <span class="na">input</span><span class="p">:</span> <span class="p">{</span> <span class="na">email</span><span class="p">:</span> <span class="dl">''</span><span class="p">,</span> <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">John</span><span class="dl">'</span> <span class="p">},</span>
        <span class="p">});</span>
      <span class="p">}).</span><span class="nx">rejects</span><span class="p">.</span><span class="nx">toThrow</span><span class="p">(</span><span class="nx">ZodValidationError</span><span class="p">);</span>

      <span class="c1">// Test that name must not be empty</span>
      <span class="k">await</span> <span class="nx">expect</span><span class="p">(</span><span class="k">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">await</span> <span class="nx">createUserExample</span><span class="p">({</span>
          <span class="na">input</span><span class="p">:</span> <span class="p">{</span> <span class="na">email</span><span class="p">:</span> <span class="dl">'</span><span class="s1">johndoe@example.com</span><span class="dl">'</span><span class="p">,</span> <span class="na">name</span><span class="p">:</span> <span class="dl">''</span> <span class="p">},</span>
        <span class="p">});</span>
      <span class="p">}).</span><span class="nx">rejects</span><span class="p">.</span><span class="nx">toThrow</span><span class="p">(</span><span class="nx">ZodValidationError</span><span class="p">);</span>

      <span class="c1">// Test with valid email and non-empty name</span>
      <span class="kd">const</span> <span class="nx">validResult</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">createUserExample</span><span class="p">({</span>
        <span class="na">input</span><span class="p">:</span> <span class="p">{</span> <span class="na">email</span><span class="p">:</span> <span class="dl">'</span><span class="s1">johndoe@example.com</span><span class="dl">'</span><span class="p">,</span> <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">John</span><span class="dl">'</span> <span class="p">},</span>
      <span class="p">});</span>

      <span class="c1">// Assert that the result has the expected email and name</span>
      <span class="nx">expect</span><span class="p">(</span><span class="nx">validResult</span><span class="p">.</span><span class="nx">email</span><span class="p">).</span><span class="nx">toEqual</span><span class="p">(</span><span class="dl">'</span><span class="s1">johndoe@example.com</span><span class="dl">'</span><span class="p">);</span>
      <span class="nx">expect</span><span class="p">(</span><span class="nx">validResult</span><span class="p">.</span><span class="nx">name</span><span class="p">).</span><span class="nx">toEqual</span><span class="p">(</span><span class="dl">'</span><span class="s1">John</span><span class="dl">'</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">)</span>
<span class="p">...</span>
</code></pre>

</div>



<p>Great! Our server is now robust. But we also need to take care of our users with l33t front-end validation.</p>

<h3>
  
  
  Client Side
</h3>

<p>To begin, we need to install dependencies in the <code>web</code> workspace:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight shell"><code><span class="nb">cd </span>web <span class="o">&amp;&amp;</span> yarn add zod @hookform/resolvers <span class="o">&amp;&amp;</span> <span class="nb">cd</span> ..
</code></pre>

</div>



<p>Now we want to use Zod in the generated <code>UserExampleForm</code>.</p>

<p><strong>Note</strong>: Oh no! Redwood validation is so easy why should i change it !? Don't panic! Redwood validation is built on <a href="https://www.react-hook-form.com/">React Hook Form</a>, and we just installed a Zod resolver for it.</p>

<p>Adding Zod validation<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="c1">// UserExampleForm.tsx</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">zodResolver</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@hookform/resolvers/zod</span><span class="dl">'</span><span class="p">;</span>
<span class="p">...</span>
<span class="k">import</span> <span class="p">{</span>
  <span class="p">...</span>
  <span class="nx">useForm</span><span class="p">,</span>
<span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@redwoodjs/forms</span><span class="dl">'</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">UserExampleForm</span> <span class="o">=</span> <span class="p">(</span><span class="nx">props</span><span class="p">:</span> <span class="nx">UserExampleFormProps</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">formMethods</span> <span class="o">=</span> <span class="nx">useForm</span><span class="o">&lt;</span><span class="nx">FormUserExample</span><span class="o">&gt;</span><span class="p">({</span>
    <span class="na">resolver</span><span class="p">:</span> <span class="nx">zodResolver</span><span class="p">(</span><span class="nx">userExampleSchema</span><span class="p">),</span>
  <span class="p">});</span>

  <span class="p">...</span>
  <span class="k">return</span> <span class="p">(</span>
    <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="dl">"</span><span class="s2">rw-form-wrapper</span><span class="dl">"</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="nx">Form</span><span class="o">&lt;</span><span class="nx">FormUserExample</span><span class="o">&gt;</span>
        <span class="nx">onSubmit</span><span class="o">=</span><span class="p">{</span><span class="nx">onSubmit</span><span class="p">}</span>
        <span class="nx">error</span><span class="o">=</span><span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">error</span><span class="p">}</span>
        <span class="nx">formMethods</span><span class="o">=</span><span class="p">{</span><span class="nx">formMethods</span><span class="p">}</span>
      <span class="o">&gt;</span>
        <span class="p">...</span>
      <span class="o">&lt;</span><span class="sr">/Form</span><span class="err">&gt;
</span>    <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>  <span class="p">);</span>
<span class="p">};</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">UserExampleForm</span><span class="p">;</span>
</code></pre>

</div>



<p>You should recognize the <code>useForm()</code> method if you've gone through the tutorial. It's used to reset the Article Form. The Zod resolver is a small addition to it, and that's all the hard work to make it work.</p>

<p>If you test the form, it should send the same errors but from the client !<br>
But wait how i can be sure it‚Äôs not the server which throws the error ? <br>
Well you can comment the line of <code>validateWithZod</code> in the service if you dare ! But you could also just check network in chrome dev tools or the server's logs  ;)</p>

<p><strong>ET VOILA</strong> <br>
Now you have a Zod setup for both the client and server! </p>

<p>Hope you learned something ! cheers</p>

<p><em>NB</em>: if you want to deploy this app you will have to copy the common dir in the "web" folder <em>before</em> the build !</p>

 </details> 
 <hr /> 

 #### - [Mastering useEffect: Rules, Best Practices, and Pitfalls](https://dev.to/cybermaxi7/mastering-useeffect-rules-best-practices-and-pitfalls-353e) 
 <details><summary>Article</summary> <p>In the world of React, the <code>useEffect</code> hook is a powerful tool for handling side effects and managing component lifecycle. However, wielding this power comes with great responsibility. In this comprehensive guide, we'll delve into the rules, best practices, and common pitfalls when working with <code>useEffect</code>.</p>

<p><strong>Dependency Array Rules</strong></p>

<ol>
<li><p><strong>Inclusive Dependencies:</strong> The dependency array is your compass. Every state variable, prop, or context used inside the effect must find its place in this array. It ensures that your effect runs whenever any of these values change.</p></li>
<li><p><strong>Reactivity Matters:</strong> Reactive values are the lifeblood of <code>useEffect</code>. Any function or variable that references another reactive value should be included. Don't forget, everything related to state, props, or context is a reactive value.</p></li>
<li><p><strong>Dependency Is Not Optional:</strong> Dependencies choose themselves. Avoid ignoring the dependency ESLint rule; it helps you avoid unexpected behavior and bugs.</p></li>
<li><p><strong>No Objects or Arrays:</strong> Objects and arrays should stay out of the dependency array. They're recreated on every render, and React considers a new object as different from the old one. (<code>{} !== {}</code>)</p></li>
</ol>

<p><strong>Removing Unnecessary Dependencies</strong></p>

<ol>
<li>
<p><strong>Function Dependencies:</strong> When it comes to functions, there are options:</p>

<ul>
<li>Move the function into the <code>useEffect</code> if it's used exclusively there.</li>
<li>If the function is reused elsewhere, consider memoizing it using <code>useCallback()</code>.</li>
<li>If the function doesn't reference any reactive value, move it outside the effect for optimal performance.</li>
</ul>
</li>
<li><p><strong>Object Dependencies:</strong> Instead of including the entire object, focus on the specific property you need, especially if it's a primitive value. If that doesn't work, consider memoization techniques.</p></li>
</ol>

<p><strong>Other Strategies</strong></p>

<ol>
<li><p><strong>Multiple Dependencies:</strong> When dealing with numerous reactive values, consider using <code>useReducer</code> to simplify your logic.</p></li>
<li><p><strong>Stable Dependencies:</strong> No need to include <code>setState</code> (from <code>useState</code>) or <code>dispatch</code> (from <code>useReducer</code>) in the dependencies. React ensures their stability across renders.</p></li>
</ol>

<p><strong>When Not to Use useEffect</strong></p>

<ol>
<li>
<strong>Last Resort:</strong> <code>useEffect</code> should be a last resort when no other solution makes sense. Consider alternatives first.</li>
</ol>

<p><strong>Cases of Overuse</strong></p>

<ol>
<li><p><strong>Event Handling:</strong> Instead of using <code>useEffect</code> for responding to an event, create an event function. It keeps your code organized and readable.</p></li>
<li><p><strong>Data Fetching:</strong> While fetching data when a component mounts might work in small apps, for real-world applications, consider using a library like <code>react-query</code> for better data management.</p></li>
<li><p><strong>Synchronizing State Changes:</strong> Avoid using <code>useEffect</code> for synchronizing state changes with one another. Opt for derived state and event handlers for a cleaner and more maintainable codebase.</p></li>
</ol>

<p>In conclusion, mastering <code>useEffect</code> involves understanding its rules, leveraging best practices, and recognizing when it's not the right tool for the job. By following these guidelines, you'll harness the true potential of <code>useEffect</code> in your React applications.</p>

 </details> 
 <hr /> 
<!-- BLOG-POST-LIST:END -->
</table>
</details>


<!-- TODO
Change the 3stats boxes around, possibly two on top and one on bottom
Fix RSSfeed
Fix Spotify Playlists
Fix Socials [Portfolio, Discord, Linkedin]
In the future, add Public Repositories of Selected Projects
-->
